<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R Programming for Research</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is a bookdown version of the course notes for R Programming for Research, Colorado State University, Fall 2016.">
  <meta name="generator" content="bookdown 0.1.9 and GitBook 2.6.7">

  <meta property="og:title" content="R Programming for Research" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a bookdown version of the course notes for R Programming for Research, Colorado State University, Fall 2016." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Programming for Research" />
  
  <meta name="twitter:description" content="This is a bookdown version of the course notes for R Programming for Research, Colorado State University, Fall 2016." />
  

<meta name="author" content="Brooke Anderson and Rachel Severson">

  
<meta name="date" content="2016-09-25">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="entering-and-cleaning-data-1.html">
<link rel="next" href="reporting-data-results-1.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Authoring Books with R Markdown</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Online course book, ERHS 535</a></li>
<li class="chapter" data-level="" data-path="course-information.html"><a href="course-information.html"><i class="fa fa-check"></i>Course information</a><ul>
<li class="chapter" data-level="0.1" data-path="course-information.html"><a href="course-information.html#course-overview"><i class="fa fa-check"></i><b>0.1</b> Course overview</a></li>
<li class="chapter" data-level="0.2" data-path="course-information.html"><a href="course-information.html#time-and-place"><i class="fa fa-check"></i><b>0.2</b> Time and place</a></li>
<li class="chapter" data-level="0.3" data-path="course-information.html"><a href="course-information.html#detailed-schedule"><i class="fa fa-check"></i><b>0.3</b> Detailed schedule</a></li>
<li class="chapter" data-level="0.4" data-path="course-information.html"><a href="course-information.html#grading"><i class="fa fa-check"></i><b>0.4</b> Grading</a><ul>
<li class="chapter" data-level="0.4.1" data-path="course-information.html"><a href="course-information.html#attendance-and-class-participation"><i class="fa fa-check"></i><b>0.4.1</b> Attendance and class participation</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="course-information.html"><a href="course-information.html#weekly-in-course-group-exercises"><i class="fa fa-check"></i><b>0.5</b> Weekly in-course group exercises</a><ul>
<li class="chapter" data-level="0.5.1" data-path="course-information.html"><a href="course-information.html#in-class-quizzes"><i class="fa fa-check"></i><b>0.5.1</b> In-class quizzes</a></li>
<li class="chapter" data-level="0.5.2" data-path="course-information.html"><a href="course-information.html#homework"><i class="fa fa-check"></i><b>0.5.2</b> Homework</a></li>
<li class="chapter" data-level="0.5.3" data-path="course-information.html"><a href="course-information.html#final-group-project"><i class="fa fa-check"></i><b>0.5.3</b> Final group project</a></li>
</ul></li>
<li class="chapter" data-level="0.6" data-path="course-information.html"><a href="course-information.html#course-set-up"><i class="fa fa-check"></i><b>0.6</b> Course set-up</a></li>
<li class="chapter" data-level="0.7" data-path="course-information.html"><a href="course-information.html#helpful-books-for-learning-r"><i class="fa fa-check"></i><b>0.7</b> Helpful books for learning R</a></li>
</ul></li>
<li class="part"><span><b>Part I: Preliminaries</b></span></li>
<li class="chapter" data-level="1" data-path="r-preliminaries.html"><a href="r-preliminaries.html"><i class="fa fa-check"></i><b>1</b> R Preliminaries</a><ul>
<li class="chapter" data-level="1.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#r-and-r-studio"><i class="fa fa-check"></i><b>1.1</b> R and R Studio</a><ul>
<li class="chapter" data-level="1.1.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#what-is-r"><i class="fa fa-check"></i><b>1.1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.1.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#open-source-software"><i class="fa fa-check"></i><b>1.1.2</b> Open-source software</a></li>
<li class="chapter" data-level="1.1.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.1.3</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.1.4" data-path="r-preliminaries.html"><a href="r-preliminaries.html#setting-up"><i class="fa fa-check"></i><b>1.1.4</b> Setting up</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#the-package-system"><i class="fa fa-check"></i><b>1.2</b> The “package” system</a><ul>
<li class="chapter" data-level="1.2.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#r-packages"><i class="fa fa-check"></i><b>1.2.1</b> R packages</a></li>
<li class="chapter" data-level="1.2.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#installing-from-cran"><i class="fa fa-check"></i><b>1.2.2</b> Installing from CRAN</a></li>
<li class="chapter" data-level="1.2.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#loading-an-installed-package"><i class="fa fa-check"></i><b>1.2.3</b> Loading an installed package</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#basic-code-conventions-of-r"><i class="fa fa-check"></i><b>1.3</b> Basic code conventions of R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#rs-mvp-the-gets-arrow"><i class="fa fa-check"></i><b>1.3.1</b> R’s MVP: The <em>gets arrow</em></a></li>
<li class="chapter" data-level="1.3.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#assignment-operator-wars---vs."><i class="fa fa-check"></i><b>1.3.2</b> Assignment operator wars: <code>&lt;-</code> vs. <code>=</code></a></li>
<li class="chapter" data-level="1.3.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#naming-objects"><i class="fa fa-check"></i><b>1.3.3</b> Naming objects</a></li>
<li class="chapter" data-level="1.3.4" data-path="r-preliminaries.html"><a href="r-preliminaries.html#commenting-code"><i class="fa fa-check"></i><b>1.3.4</b> Commenting code</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-preliminaries.html"><a href="r-preliminaries.html#rs-most-basic-object-types"><i class="fa fa-check"></i><b>1.4</b> R’s most basic object types</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#vectors"><i class="fa fa-check"></i><b>1.4.1</b> Vectors</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#dataframes"><i class="fa fa-check"></i><b>1.4.2</b> Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-preliminaries.html"><a href="r-preliminaries.html#using-r-functions"><i class="fa fa-check"></i><b>1.5</b> Using R functions</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#function-structure"><i class="fa fa-check"></i><b>1.5.1</b> Function structure</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#function-help-files"><i class="fa fa-check"></i><b>1.5.2</b> Function help files</a></li>
<li class="chapter" data-level="1.5.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#function-parameters"><i class="fa fa-check"></i><b>1.5.3</b> Function parameters</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-preliminaries.html"><a href="r-preliminaries.html#in-course-exercise"><i class="fa fa-check"></i><b>1.6</b> In-course Exercise</a><ul>
<li class="chapter" data-level="1.6.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#about-the-dataset"><i class="fa fa-check"></i><b>1.6.1</b> About the dataset</a></li>
<li class="chapter" data-level="1.6.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#getting-the-data-onto-your-computer"><i class="fa fa-check"></i><b>1.6.2</b> Getting the data onto your computer</a></li>
<li class="chapter" data-level="1.6.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#getting-the-data-into-r"><i class="fa fa-check"></i><b>1.6.3</b> Getting the data into R</a></li>
<li class="chapter" data-level="1.6.4" data-path="r-preliminaries.html"><a href="r-preliminaries.html#checking-out-the-data"><i class="fa fa-check"></i><b>1.6.4</b> Checking out the data</a></li>
<li class="chapter" data-level="1.6.5" data-path="r-preliminaries.html"><a href="r-preliminaries.html#using-the-data-to-answer-questions"><i class="fa fa-check"></i><b>1.6.5</b> Using the data to answer questions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Part II: Basics</b></span></li>
<li class="chapter" data-level="2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html"><i class="fa fa-check"></i><b>2</b> Entering and cleaning data #1</a><ul>
<li class="chapter" data-level="2.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#r-scripts"><i class="fa fa-check"></i><b>2.1</b> R scripts</a></li>
<li class="chapter" data-level="2.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#directories-and-pathnames"><i class="fa fa-check"></i><b>2.2</b> Directories and pathnames</a><ul>
<li class="chapter" data-level="2.2.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#directory-structure"><i class="fa fa-check"></i><b>2.2.1</b> Directory structure</a></li>
<li class="chapter" data-level="2.2.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#working-directory"><i class="fa fa-check"></i><b>2.2.2</b> Working directory</a></li>
<li class="chapter" data-level="2.2.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#file-and-directory-pathnames"><i class="fa fa-check"></i><b>2.2.3</b> File and directory pathnames</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#diversion-paste"><i class="fa fa-check"></i><b>2.3</b> Diversion: <code>paste</code></a></li>
<li class="chapter" data-level="2.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.4</b> Reading data into R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-local-flat-files"><i class="fa fa-check"></i><b>2.4.1</b> Reading local flat files</a></li>
<li class="chapter" data-level="2.4.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#the-read_-functions"><i class="fa fa-check"></i><b>2.4.2</b> The <code>read_*</code> functions</a></li>
<li class="chapter" data-level="2.4.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-online-flat-files"><i class="fa fa-check"></i><b>2.4.3</b> Reading online flat files</a></li>
<li class="chapter" data-level="2.4.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#saving-and-loading-r-objects"><i class="fa fa-check"></i><b>2.4.4</b> Saving and loading R objects</a></li>
<li class="chapter" data-level="2.4.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-other-file-types"><i class="fa fa-check"></i><b>2.4.5</b> Reading other file types</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#data-cleaning"><i class="fa fa-check"></i><b>2.5</b> Data cleaning</a><ul>
<li class="chapter" data-level="2.5.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#renaming-columns"><i class="fa fa-check"></i><b>2.5.1</b> Renaming columns</a></li>
<li class="chapter" data-level="2.5.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#selecting-columns"><i class="fa fa-check"></i><b>2.5.2</b> Selecting columns</a></li>
<li class="chapter" data-level="2.5.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#filtering-to-certain-rows"><i class="fa fa-check"></i><b>2.5.3</b> Filtering to certain rows</a></li>
<li class="chapter" data-level="2.5.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#add-or-change-columns"><i class="fa fa-check"></i><b>2.5.4</b> Add or change columns</a></li>
<li class="chapter" data-level="2.5.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#piping"><i class="fa fa-check"></i><b>2.5.5</b> Piping</a></li>
<li class="chapter" data-level="2.5.6" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#base-r-equivalents-to-dplyr-functions"><i class="fa fa-check"></i><b>2.5.6</b> Base R equivalents to <code>dplyr</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#dates-in-r"><i class="fa fa-check"></i><b>2.6</b> Dates in R</a></li>
<li class="chapter" data-level="2.7" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#in-course-exercise-1"><i class="fa fa-check"></i><b>2.7</b> In-course Exercise</a><ul>
<li class="chapter" data-level="2.7.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#checking-out-directory-structures"><i class="fa fa-check"></i><b>2.7.1</b> Checking out directory structures</a></li>
<li class="chapter" data-level="2.7.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#using-relative-and-absolute-file-pathnames"><i class="fa fa-check"></i><b>2.7.2</b> Using relative and absolute file pathnames</a></li>
<li class="chapter" data-level="2.7.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-in-different-types-of-files"><i class="fa fa-check"></i><b>2.7.3</b> Reading in different types of files</a></li>
<li class="chapter" data-level="2.7.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#cleaning-up-data"><i class="fa fa-check"></i><b>2.7.4</b> Cleaning up data</a></li>
<li class="chapter" data-level="2.7.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#a-taste-of-whats-to-come"><i class="fa fa-check"></i><b>2.7.5</b> A taste of what’s to come…</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exploring-data-1.html"><a href="exploring-data-1.html"><i class="fa fa-check"></i><b>3</b> Exploring data #1</a><ul>
<li class="chapter" data-level="3.1" data-path="exploring-data-1.html"><a href="exploring-data-1.html#data-from-a-package"><i class="fa fa-check"></i><b>3.1</b> Data from a package</a></li>
<li class="chapter" data-level="3.2" data-path="exploring-data-1.html"><a href="exploring-data-1.html#plots-to-explore-data"><i class="fa fa-check"></i><b>3.2</b> Plots to explore data</a><ul>
<li class="chapter" data-level="3.2.1" data-path="exploring-data-1.html"><a href="exploring-data-1.html#initializing-a-ggplot-object"><i class="fa fa-check"></i><b>3.2.1</b> Initializing a ggplot object</a></li>
<li class="chapter" data-level="3.2.2" data-path="exploring-data-1.html"><a href="exploring-data-1.html#plot-aesthetics"><i class="fa fa-check"></i><b>3.2.2</b> Plot aesthetics</a></li>
<li class="chapter" data-level="3.2.3" data-path="exploring-data-1.html"><a href="exploring-data-1.html#adding-geoms"><i class="fa fa-check"></i><b>3.2.3</b> Adding geoms</a></li>
<li class="chapter" data-level="3.2.4" data-path="exploring-data-1.html"><a href="exploring-data-1.html#constant-aesthetics"><i class="fa fa-check"></i><b>3.2.4</b> Constant aesthetics</a></li>
<li class="chapter" data-level="3.2.5" data-path="exploring-data-1.html"><a href="exploring-data-1.html#useful-plot-additions"><i class="fa fa-check"></i><b>3.2.5</b> Useful plot additions</a></li>
<li class="chapter" data-level="3.2.6" data-path="exploring-data-1.html"><a href="exploring-data-1.html#example-dataset"><i class="fa fa-check"></i><b>3.2.6</b> Example dataset</a></li>
<li class="chapter" data-level="3.2.7" data-path="exploring-data-1.html"><a href="exploring-data-1.html#histograms"><i class="fa fa-check"></i><b>3.2.7</b> Histograms</a></li>
<li class="chapter" data-level="3.2.8" data-path="exploring-data-1.html"><a href="exploring-data-1.html#scatterplots"><i class="fa fa-check"></i><b>3.2.8</b> Scatterplots</a></li>
<li class="chapter" data-level="3.2.9" data-path="exploring-data-1.html"><a href="exploring-data-1.html#boxplots"><i class="fa fa-check"></i><b>3.2.9</b> Boxplots</a></li>
<li class="chapter" data-level="3.2.10" data-path="exploring-data-1.html"><a href="exploring-data-1.html#extensions-of-ggplot2"><i class="fa fa-check"></i><b>3.2.10</b> Extensions of <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="exploring-data-1.html"><a href="exploring-data-1.html#simple-statistics-functions"><i class="fa fa-check"></i><b>3.3</b> Simple statistics functions</a><ul>
<li class="chapter" data-level="3.3.1" data-path="exploring-data-1.html"><a href="exploring-data-1.html#summary-statistics"><i class="fa fa-check"></i><b>3.3.1</b> Summary statistics</a></li>
<li class="chapter" data-level="3.3.2" data-path="exploring-data-1.html"><a href="exploring-data-1.html#summarize-function"><i class="fa fa-check"></i><b>3.3.2</b> <code>summarize</code> function</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="exploring-data-1.html"><a href="exploring-data-1.html#logical-vectors"><i class="fa fa-check"></i><b>3.4</b> Logical vectors</a></li>
<li class="chapter" data-level="3.5" data-path="exploring-data-1.html"><a href="exploring-data-1.html#regression-models"><i class="fa fa-check"></i><b>3.5</b> Regression models</a><ul>
<li class="chapter" data-level="3.5.1" data-path="exploring-data-1.html"><a href="exploring-data-1.html#formula-structure"><i class="fa fa-check"></i><b>3.5.1</b> Formula structure</a></li>
<li class="chapter" data-level="3.5.2" data-path="exploring-data-1.html"><a href="exploring-data-1.html#linear-models"><i class="fa fa-check"></i><b>3.5.2</b> Linear models</a></li>
<li class="chapter" data-level="3.5.3" data-path="exploring-data-1.html"><a href="exploring-data-1.html#generalized-linear-models-glms"><i class="fa fa-check"></i><b>3.5.3</b> Generalized linear models (GLMs)</a></li>
<li class="chapter" data-level="3.5.4" data-path="exploring-data-1.html"><a href="exploring-data-1.html#references-statistics-in-r"><i class="fa fa-check"></i><b>3.5.4</b> References– statistics in R</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="exploring-data-1.html"><a href="exploring-data-1.html#in-course-exercise-2"><i class="fa fa-check"></i><b>3.6</b> In-course exercise</a><ul>
<li class="chapter" data-level="3.6.1" data-path="exploring-data-1.html"><a href="exploring-data-1.html#loading-data-from-an-r-package"><i class="fa fa-check"></i><b>3.6.1</b> Loading data from an R package</a></li>
<li class="chapter" data-level="3.6.2" data-path="exploring-data-1.html"><a href="exploring-data-1.html#basic-plots-of-the-data"><i class="fa fa-check"></i><b>3.6.2</b> Basic plots of the data</a></li>
<li class="chapter" data-level="3.6.3" data-path="exploring-data-1.html"><a href="exploring-data-1.html#exploring-the-data-using-simple-statistics-and-logical-statements"><i class="fa fa-check"></i><b>3.6.3</b> Exploring the data using simple statistics and logical statements</a></li>
<li class="chapter" data-level="3.6.4" data-path="exploring-data-1.html"><a href="exploring-data-1.html#using-regression-models-to-explore-data"><i class="fa fa-check"></i><b>3.6.4</b> Using regression models to explore data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html"><i class="fa fa-check"></i><b>4</b> Reporting data results #1</a><ul>
<li class="chapter" data-level="4.1" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#guidelines-for-good-plots"><i class="fa fa-check"></i><b>4.1</b> Guidelines for good plots</a></li>
<li class="chapter" data-level="4.2" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#high-data-density"><i class="fa fa-check"></i><b>4.2</b> High data density</a><ul>
<li class="chapter" data-level="4.2.1" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#meaningful-labels"><i class="fa fa-check"></i><b>4.2.1</b> Meaningful labels</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#references"><i class="fa fa-check"></i><b>4.3</b> References</a></li>
<li class="chapter" data-level="4.4" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#highlighting"><i class="fa fa-check"></i><b>4.4</b> Highlighting</a></li>
<li class="chapter" data-level="4.5" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#order"><i class="fa fa-check"></i><b>4.5</b> Order</a></li>
<li class="chapter" data-level="4.6" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#small-multiples"><i class="fa fa-check"></i><b>4.6</b> Small multiples</a></li>
<li class="chapter" data-level="4.7" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#advanced-customization"><i class="fa fa-check"></i><b>4.7</b> Advanced customization</a><ul>
<li class="chapter" data-level="4.7.1" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#scales"><i class="fa fa-check"></i><b>4.7.1</b> Scales</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#to-find-out-more"><i class="fa fa-check"></i><b>4.8</b> To find out more</a></li>
<li class="chapter" data-level="4.9" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#in-course-exercise-3"><i class="fa fa-check"></i><b>4.9</b> In-course exercise</a><ul>
<li class="chapter" data-level="4.9.1" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#designing-a-plot"><i class="fa fa-check"></i><b>4.9.1</b> Designing a plot</a></li>
<li class="chapter" data-level="4.9.2" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#basic-scatterplots-with-r-base-graphics-and-ggplot"><i class="fa fa-check"></i><b>4.9.2</b> Basic scatterplots with R base graphics and ggplot</a></li>
<li class="chapter" data-level="4.9.3" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#fancier-graphs"><i class="fa fa-check"></i><b>4.9.3</b> Fancier graphs</a></li>
<li class="chapter" data-level="4.9.4" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#data-visualization-cheatsheet"><i class="fa fa-check"></i><b>4.9.4</b> Data visualization cheatsheet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html"><i class="fa fa-check"></i><b>5</b> Reproducible research #1</a><ul>
<li class="chapter" data-level="5.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#what-is-reproducible-research"><i class="fa fa-check"></i><b>5.1</b> What is reproducible research?</a></li>
<li class="chapter" data-level="5.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#markdown"><i class="fa fa-check"></i><b>5.2</b> Markdown</a></li>
<li class="chapter" data-level="5.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#literate-programming-in-r"><i class="fa fa-check"></i><b>5.3</b> Literate programming in R</a></li>
<li class="chapter" data-level="5.4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#style-guidelines"><i class="fa fa-check"></i><b>5.4</b> Style guidelines</a><ul>
<li class="chapter" data-level="5.4.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#line-length"><i class="fa fa-check"></i><b>5.4.1</b> Line length</a></li>
<li class="chapter" data-level="5.4.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#spacing"><i class="fa fa-check"></i><b>5.4.2</b> Spacing</a></li>
<li class="chapter" data-level="5.4.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#semicolons"><i class="fa fa-check"></i><b>5.4.3</b> Semicolons</a></li>
<li class="chapter" data-level="5.4.4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#commenting"><i class="fa fa-check"></i><b>5.4.4</b> Commenting</a></li>
<li class="chapter" data-level="5.4.5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#indentation"><i class="fa fa-check"></i><b>5.4.5</b> Indentation</a></li>
<li class="chapter" data-level="5.4.6" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#code-grouping"><i class="fa fa-check"></i><b>5.4.6</b> Code grouping</a></li>
<li class="chapter" data-level="5.4.7" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#broader-guidelines"><i class="fa fa-check"></i><b>5.4.7</b> Broader guidelines</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#more-with-knitr"><i class="fa fa-check"></i><b>5.5</b> More with knitr</a><ul>
<li class="chapter" data-level="5.5.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#equations-in-knitr"><i class="fa fa-check"></i><b>5.5.1</b> Equations in <code>knitr</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#figures-from-file"><i class="fa fa-check"></i><b>5.5.2</b> Figures from file</a></li>
<li class="chapter" data-level="5.5.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#saving-graphics-files"><i class="fa fa-check"></i><b>5.5.3</b> Saving graphics files</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#saving-graphics-files-1"><i class="fa fa-check"></i><b>5.6</b> Saving graphics files</a><ul>
<li class="chapter" data-level="5.6.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#tables-in-r-markdown"><i class="fa fa-check"></i><b>5.6.1</b> Tables in R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#in-course-exercise-4"><i class="fa fa-check"></i><b>5.7</b> In-course exercise</a><ul>
<li class="chapter" data-level="5.7.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#creating-a-markdown-document"><i class="fa fa-check"></i><b>5.7.1</b> Creating a Markdown document</a></li>
<li class="chapter" data-level="5.7.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#adding-in-r-code"><i class="fa fa-check"></i><b>5.7.2</b> Adding in R code</a></li>
<li class="chapter" data-level="5.7.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#working-with-r-markdown-documents"><i class="fa fa-check"></i><b>5.7.3</b> Working with R Markdown documents</a></li>
<li class="chapter" data-level="5.7.4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#r-style-guidelines"><i class="fa fa-check"></i><b>5.7.4</b> R style guidelines</a></li>
<li class="chapter" data-level="5.7.5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#trying-out-knitr-with-your-own-data"><i class="fa fa-check"></i><b>5.7.5</b> Trying out <code>knitr</code> with your own data</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html"><i class="fa fa-check"></i><b>A</b> Appendix A: Vocabulary</a><ul>
<li class="chapter" data-level="A.1" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-1-quiz-1"><i class="fa fa-check"></i><b>A.1</b> Week 1 (Quiz 1)</a></li>
<li class="chapter" data-level="A.2" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-2-quiz-2"><i class="fa fa-check"></i><b>A.2</b> Week 2 (Quiz 2)</a></li>
<li class="chapter" data-level="A.3" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-3-quiz-3"><i class="fa fa-check"></i><b>A.3</b> Week 3 (Quiz 3)</a></li>
<li class="chapter" data-level="A.4" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-4-quiz-4"><i class="fa fa-check"></i><b>A.4</b> Week 4 (Quiz 4)</a></li>
<li class="chapter" data-level="A.5" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-5-quiz-5"><i class="fa fa-check"></i><b>A.5</b> Week 5 (Quiz 5)</a></li>
<li class="chapter" data-level="A.6" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-6-quiz-6"><i class="fa fa-check"></i><b>A.6</b> Week 6 (Quiz 6)</a></li>
<li class="chapter" data-level="A.7" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-7-quiz-7"><i class="fa fa-check"></i><b>A.7</b> Week 7 (Quiz 7)</a></li>
<li class="chapter" data-level="A.8" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-8-quiz-8"><i class="fa fa-check"></i><b>A.8</b> Week 8 (Quiz 8)</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html"><i class="fa fa-check"></i><b>B</b> Appendix B: Homework</a><ul>
<li class="chapter" data-level="B.1" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-1"><i class="fa fa-check"></i><b>B.1</b> Homework #1</a><ul>
<li class="chapter" data-level="B.1.1" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#getting-started"><i class="fa fa-check"></i><b>B.1.1</b> Getting started</a></li>
<li class="chapter" data-level="B.1.2" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#swirl-lessons"><i class="fa fa-check"></i><b>B.1.2</b> Swirl lessons</a></li>
<li class="chapter" data-level="B.1.3" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#special-swirl-commands"><i class="fa fa-check"></i><b>B.1.3</b> Special swirl commands</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-2"><i class="fa fa-check"></i><b>B.2</b> Homework #2</a></li>
<li class="chapter" data-level="B.3" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-3"><i class="fa fa-check"></i><b>B.3</b> Homework #3</a></li>
<li class="chapter" data-level="B.4" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-4"><i class="fa fa-check"></i><b>B.4</b> Homework #4</a></li>
<li class="chapter" data-level="B.5" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-5"><i class="fa fa-check"></i><b>B.5</b> Homework #5</a></li>
<li class="chapter" data-level="B.6" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-6"><i class="fa fa-check"></i><b>B.6</b> Homework #6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Programming for Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exploring-data-1" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Exploring data #1</h1>
<p><a href="https://github.com/geanders/RProgrammingForResearch/raw/master/slides/CourseNotes_Week3.pdf">Download</a> a pdf of the lecture slides covering this topic.</p>
<div id="data-from-a-package" class="section level2">
<h2><span class="header-section-number">3.1</span> Data from a package</h2>
<p>So far we’ve covered three ways to get data into R:</p>
<ol style="list-style-type: decimal">
<li>From flat files (either on your computer or online)</li>
<li>From files like SAS and Excel</li>
<li>From R objects (i.e., using <code>load()</code>)</li>
</ol>
<p>Many R packages come with their own data, which is very easy to load and use. For example, the <code>faraway</code> package, which complements Julian Faraway’s book <em>Linear Models with R</em> (available as an ebook from the CSU library), has a dataset called <code>worldcup</code> that I’ll use for some examples and that you’ll use for part of this week’s in-course exercise. To load this dataset, first load the package with the data (<code>faraway</code>) and then use the <code>data()</code> function with the dataset name (“worldcup”) as the argument to the <code>data</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(faraway)
<span class="kw">data</span>(<span class="st">&quot;worldcup&quot;</span>)</code></pre></div>
<p>Unlike most data objects you’ll work with, datasets that are part of an R package will often have their own help files. You can access this help file for a dataset using the <code>?</code> operator with the dataset’s name:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?worldcup</code></pre></div>
<p>This helpful will usually include information about the size of the dataset, as well as definitions for each of the columns.</p>
<p>To get a list of all of the datasets that are available in the packages you currently have loaded, run <code>data()</code> without an option inside the parentheses:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>()</code></pre></div>
<div class="rmdnote">
<p>
If you run the <code>library</code> function without any arguments (<code>library()</code>), it works in a similar way– R will open a list of all the R packages that you have installed on your computer and can open with a <code>library</code> call.
</p>
</div>
</div>
<div id="plots-to-explore-data" class="section level2">
<h2><span class="header-section-number">3.2</span> Plots to explore data</h2>
<p>Exploratory data analysis is a key step in data analysis, and plotting your data in different ways is an important part of this process. In this section, I will focus on the basics of <code>ggplot2</code> plotting, to get you started creating some plots to explore your data. This section will focus on making <strong>useful</strong>, rather than <strong>attractive</strong> graphs, since at this stage we are focusing on exploring data for yourself rather than presenting results to others. Next week, I will explain more about how you can customize ggplot objects, to help you make plots to communicate with others.</p>
<p>All of the plots we’ll make today will use the <code>ggplot2</code> package (another member of the tidyverse!). If you don’t already have that installed, you’ll need to install it. You then need to load the package in your current session of R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages(&quot;ggplot2&quot;)  ## Uncomment and run if you don&#39;t have `ggplot2` installed</span>
<span class="kw">library</span>(ggplot2)</code></pre></div>
<p>The process of creating a plot using <code>ggplot2</code> follows conventions that are a bit different than most of the code you’ve seen so far in R (although it is somewhat similar to the idea of piping I introduced in the last chapter). The basic steps behind creating a plot with <code>ggplot2</code> are:</p>
<ol style="list-style-type: decimal">
<li>Create an object of the <code>ggplot</code> class, typically specifying the <strong>data</strong> and some or all of the <strong>aesthetics</strong>;</li>
<li>Add on <strong>geoms</strong> and other elements to create and customize the plot, using <code>+</code>.</li>
</ol>
<p>You can add on one or many geoms and other elements to create plots that range from very simple to very customized. This week, we’ll focus on simple geoms and added elements, and then explore more detailed customization next week.</p>
<div class="rmdwarning">
<p>
If R gets to the end of a line and there is not some indication that the call is not over (e.g., <code>%&gt;%</code> for piping or <code>+</code> for <code>ggplot2</code> plots), R interprets that as a message to run the call without reading in further code. A common error when writing <code>ggplot2</code> code is to put the <code>+</code> to add a geom or element at the beginning of a line rather than the end of a previous line– in this case, R will try to execute the call too soon. To avoid errors, be sure to end lines with <code>+</code>, don’t start lines with it.
</p>
</div>
<div id="initializing-a-ggplot-object" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Initializing a ggplot object</h3>
<p>The first step in creating a plot using <code>ggplot2</code> is to create a ggplot object. This object will not, by itself, create a plot with anything in it. Instead, it typically specifies the data frame you want to use and which aesthetics will be mapped to certain columns of that data frame (aesthetics are explained more in the next subsection).</p>
<p>Use the following conventions to initialize a ggplot object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generic code
object &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dataframe, <span class="kw">aes</span>(<span class="dt">x =</span> column_1, <span class="dt">y =</span> column_2))</code></pre></div>
<p>The data frame is the first parameter in a <code>ggplot</code> call and, if you like, you can use the parameter definition with that call (e.g., <code>data = dataframe</code>). Aesthetics are defined within an <code>aes</code> function call that typically is used within the <code>ggplot</code> call.</p>
<div class="rmdnote">
<p>
While the <code>ggplot</code> call is the place where you will most often see an <code>aes</code> call, <code>aes</code> can also be used within the calls to add specific geoms. This can be particularly useful if you want to map aesthetics differently for different geoms in your plot. We’ll see some examples of this use of <code>aes</code> more in later sections, when we talk about customizing plots. The <code>data</code> parameter can also be used in geom calls, to use a different data frame from the one defined when creating the original ggplot object, although this tends to be less common.
</p>
</div>
</div>
<div id="plot-aesthetics" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Plot aesthetics</h3>
<p><strong>Aesthetics</strong> are properties of the plot that can show certain elements of the data. For example, in Figure <a href="exploring-data-1.html#fig:aesmapex">3.1</a>, color shows (is mapped to) gender, x-position shows height, and y-position shows weight in a sample data set of measurements of children in Nepal.</p>
<div class="figure" style="text-align: center"><span id="fig:aesmapex"></span>
<img src="RProgrammingForResearch_files/figure-html/aesmapex-1.png" alt="Example of how different properties of a plot can show different elements to the data. Here, color indicates gender, position along the x-axis shows height, and position along the y-axis shows weight. This example is a subset of data from the `nepali` dataset in the `faraway` package." width="576" />
<p class="caption">
Figure 3.1: Example of how different properties of a plot can show different elements to the data. Here, color indicates gender, position along the x-axis shows height, and position along the y-axis shows weight. This example is a subset of data from the <code>nepali</code> dataset in the <code>faraway</code> package.
</p>
</div>
<div class="rmdnote">
<p>
Any of these aesthetics could also be given a constant value, instead of being mapped to an element of the data. For example, all the points could be red, instead of showing gender.
</p>
</div>
<p>Which aesthetics are required for a plot depend on which geoms (more on those in a second) you’re adding to the plot. You can find out the aesthetics you can use for a geom in the “Aesthetics” section of the geom’s help file (e.g., <code>?geom_point</code>). Required aesthetics are in bold in this section of the help file and optional ones are not. Common plot aesthetics you might want to specify include:</p>
<table>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>x</code></td>
<td align="left">Position on x-axis</td>
</tr>
<tr class="even">
<td align="left"><code>y</code></td>
<td align="left">Position on y-axis</td>
</tr>
<tr class="odd">
<td align="left"><code>shape</code></td>
<td align="left">Shape</td>
</tr>
<tr class="even">
<td align="left"><code>color</code></td>
<td align="left">Color of border of elements</td>
</tr>
<tr class="odd">
<td align="left"><code>fill</code></td>
<td align="left">Color of inside of elements</td>
</tr>
<tr class="even">
<td align="left"><code>size</code></td>
<td align="left">Size</td>
</tr>
<tr class="odd">
<td align="left"><code>alpha</code></td>
<td align="left">Transparency (1: opaque; 0: transparent)</td>
</tr>
<tr class="even">
<td align="left"><code>linetype</code></td>
<td align="left">Type of line (e.g., solid, dashed)</td>
</tr>
</tbody>
</table>
</div>
<div id="adding-geoms" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Adding geoms</h3>
<p>Next, you’ll want to add one or more <code>geoms</code> to create the plot. You can add these with <code>+</code> after the <code>ggplot</code> statement to initialize the ggplot object. Some of the most common geoms are:</p>
<table>
<thead>
<tr class="header">
<th align="left">Plot type</th>
<th align="left">ggplot2 function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Histogram (1 numeric variable)</td>
<td align="left"><code>geom_histogram</code></td>
</tr>
<tr class="even">
<td align="left">Scatterplot (2 numeric variables)</td>
<td align="left"><code>geom_point</code></td>
</tr>
<tr class="odd">
<td align="left">Boxplot (1 numeric variable, possibly 1 factor variable)</td>
<td align="left"><code>geom_boxplot</code></td>
</tr>
<tr class="even">
<td align="left">Line graph (2 numeric variables)</td>
<td align="left"><code>geom_line</code></td>
</tr>
</tbody>
</table>
</div>
<div id="constant-aesthetics" class="section level3">
<h3><span class="header-section-number">3.2.4</span> Constant aesthetics</h3>
<p>Instead of mapping an aesthetic to an element of your data, you can use a constant value for it. For example, you may want to make all the points green, rather than having color map to gender:</p>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-140-1.png" width="0.6\textwidth" style="display: block; margin: auto;" /></p>
<p>In this case, you’ll define that aesthetic when you add the geom, outside of an <code>aes</code> statement. In R, you can specify the shape of points with a number. Figure <a href="exploring-data-1.html#fig:shapeexamples">3.2</a> shows the shapes that correspond to the numbers 1 to 25 in the <code>shape</code> aesthetic. This figure also provides an example of the difference between color (black for all these example points) and fill (red for these examples). You can see that some point shapes include a fill (21 for example), while some are either empty (1) or solid (19).</p>
<div class="figure" style="text-align: center"><span id="fig:shapeexamples"></span>
<img src="RProgrammingForResearch_files/figure-html/shapeexamples-1.png" alt="Examples of the shapes corresponding to different numeric choices for the `shape` aesthetic. For all examples, `color` is set to black and `fill` to red." width="480" />
<p class="caption">
Figure 3.2: Examples of the shapes corresponding to different numeric choices for the <code>shape</code> aesthetic. For all examples, <code>color</code> is set to black and <code>fill</code> to red.
</p>
</div>
<p>If you want to set color to be a constant value, you can do that in R using character strings for different colors. Figure <a href="exploring-data-1.html#fig:colorexamples">3.3</a> gives an example of some of the different blues available in R. To find links to listings of different R colors, google “R colors” and search by “Images”.</p>
<div class="figure" style="text-align: center"><span id="fig:colorexamples"></span>
<img src="RProgrammingForResearch_files/figure-html/colorexamples-1.png" alt="Example of available shades of blue in R." width="480" />
<p class="caption">
Figure 3.3: Example of available shades of blue in R.
</p>
</div>
</div>
<div id="useful-plot-additions" class="section level3">
<h3><span class="header-section-number">3.2.5</span> Useful plot additions</h3>
<p>There are also a number of elements that you can add onto a <code>ggplot</code> object using <code>+</code>. A few that are used very frequently are:</p>
<table>
<thead>
<tr class="header">
<th align="left">Element</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ggtitle</code></td>
<td align="left">Plot title</td>
</tr>
<tr class="even">
<td align="left"><code>xlab</code>, <code>ylab</code></td>
<td align="left">x- and y-axis labels</td>
</tr>
<tr class="odd">
<td align="left"><code>xlim</code>, <code>ylim</code></td>
<td align="left">Limits of x- and y-axis</td>
</tr>
</tbody>
</table>
</div>
<div id="example-dataset" class="section level3">
<h3><span class="header-section-number">3.2.6</span> Example dataset</h3>
<p>For the example plots, I’ll use a dataset in the <code>faraway</code> package called <code>nepali</code>. This gives data from a study of the health of a group of Nepalese children.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(faraway)
<span class="kw">data</span>(nepali)</code></pre></div>
<p>I’ll be using functions from <code>dplyr</code> and <code>ggplot2</code>, so those need to be loaded:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)</code></pre></div>
<p>Each observation is a single measurement for a child; there can be multiple observations per child. I used the following code to select only the columns for child id, sex, weight, height, and age. I also used <code>distinct</code> to limit the dataset to only include one measurement for each chile, the child’s first measurement in the dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nepali &lt;-<span class="st"> </span>nepali %&gt;%
<span class="st">  </span><span class="kw">select</span>(id, sex, wt, ht, age) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">factor</span>(id),
         <span class="dt">sex =</span> <span class="kw">factor</span>(sex, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>))) %&gt;%
<span class="st">  </span><span class="kw">distinct</span>(id, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>After this cleaning, the data looks like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(nepali)</code></pre></div>
<pre><code>##       id    sex   wt    ht age
## 1 120011   Male 12.8  91.2  41
## 2 120012 Female 14.9 103.9  57
## 3 120021 Female  7.7  70.1   8
## 4 120022 Female 12.1  86.4  35
## 5 120023   Male 14.2  99.4  49
## 6 120031   Male 13.9  96.4  46</code></pre>
</div>
<div id="histograms" class="section level3">
<h3><span class="header-section-number">3.2.7</span> Histograms</h3>
<p>Histograms show the distribution of a single variable. Therefore, <code>geom_histogram()</code> requires only one main aesthetic, <code>x</code>, the (numeric) vector for which you want to create a histogram. For example, to create a histogram of children’s heights for the Nepali dataset (Figure <a href="exploring-data-1.html#fig:nepalihist1">3.4</a>), run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nepali, <span class="kw">aes</span>(<span class="dt">x =</span> ht)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nepalihist1"></span>
<img src="RProgrammingForResearch_files/figure-html/nepalihist1-1.png" alt="Basic example of plotting a histogram with `ggplot2`. This histogram shows the distribution of heights for the first recorded measurements of each child in the `nepali` dataset." width="384" />
<p class="caption">
Figure 3.4: Basic example of plotting a histogram with <code>ggplot2</code>. This histogram shows the distribution of heights for the first recorded measurements of each child in the <code>nepali</code> dataset.
</p>
</div>
<div class="rmdnote">
<p>
If you run the code with no arguments for <code>binwidth</code> or <code>bins</code> in <code>geom_histogram</code>, you will get a message saying “<code>stat_bin()</code> using <code>bins = 30</code>. Pick better value with <code>binwidth</code>.”. This message is just saying that a default number of bins was used to create the histogram. You can use arguments to change the number of bins used, but often this default is fine. You may also get a message that observations with missing values were removed.
</p>
</div>
<p>You can add some elements to the histogram now to customize it a bit. For example (Figure @ref()), you can add a figure title (<code>ggtitle</code>) and clearer labels for the x-axis (<code>xlab</code>). You can also change the range of values shown by the x-axis (<code>xlim</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nepali, <span class="kw">aes</span>(<span class="dt">x =</span> ht)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Height of children&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Height (cm)&quot;</span>) +<span class="st"> </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">120</span>))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nepalihist2"></span>
<img src="RProgrammingForResearch_files/figure-html/nepalihist2-1.png" alt="Example of adding ggplot elements to customize a histogram." width="384" />
<p class="caption">
Figure 3.5: Example of adding ggplot elements to customize a histogram.
</p>
</div>
<p>The geom <code>geom_histogram</code> also has special argument for setting the number of width of the bins used in the histogram. Figure <a href="#fig"><strong>??</strong></a> shows an example of how you can use the <code>bins</code> argument to change the number of bins that are used to make the histogram of height for the <code>nepali</code> dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nepali, <span class="kw">aes</span>(<span class="dt">x =</span> ht)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,
                 <span class="dt">bins =</span> <span class="dv">40</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nepalihist3"></span>
<img src="RProgrammingForResearch_files/figure-html/nepalihist3-1.png" alt="Example of using the `bins` argument to change the number of bins used in a histogram." width="384" />
<p class="caption">
Figure 3.6: Example of using the <code>bins</code> argument to change the number of bins used in a histogram.
</p>
</div>
<p>Similarly, the <code>binwidth</code> argument can be used to set the width of bins. Figure <a href="exploring-data-1.html#fig:nepalihist4">3.7</a> shows an example of using this function to create a histogram of the Nepali children’s heights with binwidths of 10 centimeters (note that this argument is set in the same units as the x variable).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nepali, <span class="kw">aes</span>(<span class="dt">x =</span> ht)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,
                 <span class="dt">binwidth =</span> <span class="dv">10</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nepalihist4"></span>
<img src="RProgrammingForResearch_files/figure-html/nepalihist4-1.png" alt="Example of using the `binwidth` argument to set the width of each bin used in a histogram." width="384" />
<p class="caption">
Figure 3.7: Example of using the <code>binwidth</code> argument to set the width of each bin used in a histogram.
</p>
</div>
</div>
<div id="scatterplots" class="section level3">
<h3><span class="header-section-number">3.2.8</span> Scatterplots</h3>
<p>A scatterplot shows how one variable changes as another changes. You can use the <code>geom_point</code> geom to create a scatterplot. For example, to create a scatterplot of height versus age for the Nepali data (Figure <a href="exploring-data-1.html#fig:nepaliscatter1">3.8</a>), you can run the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nepali, <span class="kw">aes</span>(<span class="dt">x =</span> ht, <span class="dt">y =</span> wt)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nepaliscatter1"></span>
<img src="RProgrammingForResearch_files/figure-html/nepaliscatter1-1.png" alt="Example of creating a scatterplot. This scatterplot shows the relationship between children's heights and weights within the nepali dataset." width="480" />
<p class="caption">
Figure 3.8: Example of creating a scatterplot. This scatterplot shows the relationship between children’s heights and weights within the nepali dataset.
</p>
</div>
<p>Again, you can use some of the options and additions to change the plot appearance. For example, to add a title, change the x- and y-axis labels, and change the color and size of the points on the scatterplot (Figure <a href="exploring-data-1.html#fig:nepaliscatter2">3.9</a>), you can run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nepali, <span class="kw">aes</span>(<span class="dt">x =</span> ht, <span class="dt">y =</span> wt)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Weight versus Height&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Height (cm)&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Weight (kg)&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nepaliscatter2"></span>
<img src="RProgrammingForResearch_files/figure-html/nepaliscatter2-1.png" alt="Example of adding ggplot elements to customize a scatterplot." width="480" />
<p class="caption">
Figure 3.9: Example of adding ggplot elements to customize a scatterplot.
</p>
</div>
<p>You can also try mapping another variable in the dataset to the <code>color</code> aesthetic. For example, to use color to show the sex of each child in the scatterplot (Figure <a href="exploring-data-1.html#fig:nepaliscatter3">3.10</a>), you can run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nepali, <span class="kw">aes</span>(<span class="dt">x =</span> ht, <span class="dt">y =</span> wt, <span class="dt">color =</span> sex)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">0.5</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Weight versus Height&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Height (cm)&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Weight (kg)&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nepaliscatter3"></span>
<img src="RProgrammingForResearch_files/figure-html/nepaliscatter3-1.png" alt="Example of mapping color to an element of the data in a scatterplot." width="480" />
<p class="caption">
Figure 3.10: Example of mapping color to an element of the data in a scatterplot.
</p>
</div>
</div>
<div id="boxplots" class="section level3">
<h3><span class="header-section-number">3.2.9</span> Boxplots</h3>
<p>Boxplots can be used to show the distribution of a continuous variable. To create a boxplot, you can use the <code>geom_boxplot</code> geom. To plot a boxplot for a single, continuous variable, you can map that variable to <code>y</code> in the <code>aes</code> call, and map <code>x</code> to the constant <code>1</code>. For example, to create a boxplot of the heights of children in the Nepali dataset (Figure <a href="exploring-data-1.html#fig:nepaliboxplot1">3.11</a>), you can run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nepali, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> ht)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>)+<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Height (cm)&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nepaliboxplot1"></span>
<img src="RProgrammingForResearch_files/figure-html/nepaliboxplot1-1.png" alt="Example of creating a boxplot. The example shows the distribution of height data for children in the nepali dataset." width="384" />
<p class="caption">
Figure 3.11: Example of creating a boxplot. The example shows the distribution of height data for children in the nepali dataset.
</p>
</div>
<p>You can also create separate boxplots, one for each level of a factor (Figure <a href="exploring-data-1.html#fig:nepaliboxplot2">3.12</a>). In this case, you’ll need to include two aesthetics (<code>x</code> and <code>y</code>) when you initialize the ggplot object The <code>y</code> variable is the variable for which the distribution will be shown, and the <code>x</code> variable should be a discrete (categorical or TRUE/FALSE) variable, and will be used to group the variable. This <code>x</code> variable should also be specified as the grouping variable, using <code>group</code> within the aesthetic call.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nepali, <span class="kw">aes</span>(<span class="dt">x =</span> sex, <span class="dt">y =</span> ht, <span class="dt">group =</span> sex)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Sex&quot;</span>)+<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Height (cm)&quot;</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:nepaliboxplot2"></span>
<img src="RProgrammingForResearch_files/figure-html/nepaliboxplot2-1.png" alt="Example of creating separate boxplots, divided by a categorical grouping variable in the data." width="480" />
<p class="caption">
Figure 3.12: Example of creating separate boxplots, divided by a categorical grouping variable in the data.
</p>
</div>
</div>
<div id="extensions-of-ggplot2" class="section level3">
<h3><span class="header-section-number">3.2.10</span> Extensions of <code>ggplot2</code></h3>
<p>There are lots of R extensions for creating other interesting plots. For example, you can use the <code>ggpairs</code> function from the <code>GGally</code> package to plot all pairs of scatterplots for several variables (Figure <a href="exploring-data-1.html#fig:ggallyexample">3.13</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">ggpairs</span>(nepali %&gt;%<span class="st"> </span><span class="kw">select</span>(sex, wt, ht, age))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ggallyexample"></span>
<img src="RProgrammingForResearch_files/figure-html/ggallyexample-1.png" alt="Example of using ggpairs from the GGally package for exploratory data analysis." width="\textwidth" />
<p class="caption">
Figure 3.13: Example of using ggpairs from the GGally package for exploratory data analysis.
</p>
</div>
<p>Notice how this output shows continuous and binary variables differently. For example, the center diagonal shows density plots for continuous variables, but a bar chart for the categorical variable.</p>
<p>See <a href="https://www.ggplot2-exts.org" class="uri">https://www.ggplot2-exts.org</a> to find more <code>ggplot2</code> extensions.</p>
</div>
</div>
<div id="simple-statistics-functions" class="section level2">
<h2><span class="header-section-number">3.3</span> Simple statistics functions</h2>
<div id="summary-statistics" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Summary statistics</h3>
<p>To explore your data, you’ll need to be able to calculate some simple statistics for vectors, including calculating the mean and range of continuous variables and counting the number of values in each category of a factor or logical vector.</p>
<p>Here are some simple statistics functions you will likely use often:</p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>range()</code></td>
<td align="left">Range (minimum and maximum) of vector</td>
</tr>
<tr class="even">
<td align="left"><code>min()</code>, <code>max()</code></td>
<td align="left">Minimum or maximum of vector</td>
</tr>
<tr class="odd">
<td align="left"><code>mean()</code>, <code>median()</code></td>
<td align="left">Mean or median of vector</td>
</tr>
<tr class="even">
<td align="left"><code>sd()</code></td>
<td align="left">Standard deviation of vector</td>
</tr>
<tr class="odd">
<td align="left"><code>table()</code></td>
<td align="left">Number of observations per level for a factor vector</td>
</tr>
<tr class="even">
<td align="left"><code>cor()</code></td>
<td align="left">Determine correlation(s) between two or more vectors</td>
</tr>
<tr class="odd">
<td align="left"><code>summary()</code></td>
<td align="left">Summary statistics, depends on class</td>
</tr>
</tbody>
</table>
<p>All of these functions take, as the main argument, the vector or vectors for which you want the statistic. If there are missing values in the vector, you’ll typically need to add an argument to say what to do with the missing values. The parameter name for this varies by function, but for many of these functions it’s <code>na.rm = TRUE</code> or <code>use=&quot;complete.obs&quot;</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(nepali$wt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 10.18432</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(nepali$ht, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1]  52.4 104.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(nepali$ht, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 12.64529</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(nepali$sex)</code></pre></div>
<pre><code>## 
##   Male Female 
##    107     93</code></pre>
<p>Most of these functions take a single vector as the input. The <code>cor</code> function, however, calculates the correlation between vectors and so takes two or more vectors. If you give it multiple values, it will give the correlation matrix for all the vectors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(nepali$wt, nepali$ht, <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>)</code></pre></div>
<pre><code>## [1] 0.9571535</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>((nepali %&gt;%<span class="st"> </span><span class="kw">select</span>(wt, ht, age)), <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>)</code></pre></div>
<pre><code>##            wt        ht       age
## wt  1.0000000 0.9571535 0.8931195
## ht  0.9571535 1.0000000 0.9287129
## age 0.8931195 0.9287129 1.0000000</code></pre>
<p>R supports object-oriented programming. Your first taste of this shows up with the <code>summary</code> function. For the <code>summary</code> function, R does not run the same code every time. Instead, R first checks what type of object was input to <code>summary</code>, and then it runs a function (<em>method</em>) specific to that type of object. For example, if you input a continuous vector, like the <code>ht</code> column in <code>nepali</code>, to <code>summary</code>, the function will return the mean, median, range, and 25th and 75th percentile values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(nepali$wt)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##    3.80    7.90   10.10   10.18   12.40   16.70      15</code></pre>
<p>However, if you submit a factor vector, like the <code>sex</code> column in <code>nepali</code>, the <code>summary</code> function will return a count of how many elements of the vector are in each factor level (as a note, you could do the same thing with the <code>table</code> function):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(nepali$sex)</code></pre></div>
<pre><code>##   Male Female 
##    107     93</code></pre>
<p>The <code>summary</code> function can also input other data structures, including dataframes, lists, and special object types, like regression model objects. In each case, it performs different actions specific to the object type. Later in this section, we’ll cover regression models, and see what the <code>summary</code> function returns when it is used with regression model objects.</p>
</div>
<div id="summarize-function" class="section level3">
<h3><span class="header-section-number">3.3.2</span> <code>summarize</code> function</h3>
<p>You will often want to use these functions in conjunction with the <code>summarize</code> function in <code>dplyr</code>. For example, to create a new dataframe with the mean weight of children in the <code>nepali</code> dataset, you can use <code>mean</code> inside a <code>summarize</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nepali %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_wt =</span> <span class="kw">mean</span>(wt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>##    mean_wt
## 1 10.18432</code></pre>
<p>There are also some special functions that you can use with <code>summarize</code>. For example, the <code>n</code> function will calculate the number of observations and the <code>first</code> function will return the first value of a column:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nepali %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n_children =</span><span class="kw">n</span>(), 
            <span class="dt">first_id =</span> <span class="kw">first</span>(id))</code></pre></div>
<pre><code>##   n_children first_id
## 1        200   120011</code></pre>
<p>See the “summary function” section of the <a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">the RStudio Data Wrangling cheatsheet</a> for more examples of these special functions.</p>
<p>Often, you will be more interested in summaries within certain groupings of your data, rather than overall summaries. For example, you may be interested in mean height and weight by sex, rather than across all children, for the <code>nepali</code> data. It is very easy to calculate these grouped summaries using <code>dplyr</code>– you just need to group data using the <code>group_by</code> function (also a <code>dplyr</code> function) before you run the <code>summarize</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nepali %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(sex) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_wt =</span> <span class="kw">mean</span>(wt, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n_children =</span><span class="kw">n</span>(), 
            <span class="dt">first_id =</span> <span class="kw">first</span>(id))</code></pre></div>
<pre><code>## # A tibble: 2 × 4
##      sex   mean_wt n_children first_id
##   &lt;fctr&gt;     &lt;dbl&gt;      &lt;int&gt;   &lt;fctr&gt;
## 1   Male 10.497980        107   120011
## 2 Female  9.823256         93   120012</code></pre>
<div class="rmdnote">
<p>
Don’t forget that you need to save the output to a new object if you want to use it later. The above code, which creates a dataframe with summaries for Nepali children by sex, will only be printed out to your console if run as-is. If you’d like to save this output as an object to use later (for example, for a plot or table), you need to assign it to an R object.
</p>
</div>
</div>
</div>
<div id="logical-vectors" class="section level2">
<h2><span class="header-section-number">3.4</span> Logical vectors</h2>
<p>Last week, you learned a lot about logical statements and how to use them with the <code>filter</code> function. You can also use logical vectors, created with these logical statements, for a lot of other things. For example, you can use them directly in the square bracket indexing (<code>[..., ...]</code>) to pull out just the rows of a dataframe that meet a certain condition.</p>
<p>When you run a logical statement on a vector, you create a logical vector the same length as the original vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">is_male &lt;-<span class="st"> </span>nepali$sex ==<span class="st"> &quot;Male&quot;</span>
<span class="kw">length</span>(nepali$sex)</code></pre></div>
<pre><code>## [1] 200</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(is_male)</code></pre></div>
<pre><code>## [1] 200</code></pre>
<p>The logical vector (<code>is_male</code> in this example) will have the value <code>TRUE</code> at any position where the original vector (<code>nepali$sex</code> in this example) met the logical condition you tested, and <code>FALSE</code> anywhere else:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(nepali$sex)</code></pre></div>
<pre><code>## [1] Male   Female Female Female Male   Male  
## Levels: Male Female</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(is_male)</code></pre></div>
<pre><code>## [1]  TRUE FALSE FALSE FALSE  TRUE  TRUE</code></pre>
<p>You can “flip” this logical vector (i.e., change every <code>TRUE</code> to <code>FALSE</code> and vice-versa) using the <em>bang operator</em>, <code>!</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(is_male)</code></pre></div>
<pre><code>## [1]  TRUE FALSE FALSE FALSE  TRUE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(!is_male)</code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<p>The bang operator turns out to be very useful. You will often find cases where it’s difficult to write a logical vector to get what you want, but fairly easy to write the inverse (find everything you don’t want). One example is filtering down to non-missing values– the <code>is.na</code> function will return <code>TRUE</code> for any value that is <code>NA</code>, so you can use <code>!is.na()</code> to identify any non-missing values.</p>
<p>You can do a few cool things with a logical vector. For example, you can use it with indexing to pull out just the rows of a dataframe where <code>is_male</code> is <code>TRUE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(nepali[is_male, ])</code></pre></div>
<pre><code>##        id  sex   wt   ht age
## 1  120011 Male 12.8 91.2  41
## 5  120023 Male 14.2 99.4  49
## 6  120031 Male 13.9 96.4  46
## 7  120051 Male  8.3 69.5   8
## 9  120053 Male 15.8 96.0  54
## 11 120062 Male 12.1 89.9  57</code></pre>
<p>Or, with <code>!</code>, just the rows where <code>is_male</code> is <code>FALSE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(nepali[!is_male, ])</code></pre></div>
<pre><code>##        id    sex   wt    ht age
## 2  120012 Female 14.9 103.9  57
## 3  120021 Female  7.7  70.1   8
## 4  120022 Female 12.1  86.4  35
## 8  120052 Female 11.8  83.6  32
## 10 120061 Female  8.7  78.5  26
## 15 120082 Female 11.2  79.8  36</code></pre>
<p>For these cases, the length of the logical vector and the number of rows in the dataframe will match.</p>
<p>You can also use <code>sum()</code> and <code>table()</code> with a logical vector to find out how many of the values in the vector are <code>TRUE</code> AND <code>FALSE</code>. In the example, you can use these functions to find out how many males and females are in the dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(is_male)</code></pre></div>
<pre><code>## [1] 107</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(!is_male)</code></pre></div>
<pre><code>## [1] 93</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(is_male)</code></pre></div>
<pre><code>## is_male
## FALSE  TRUE 
##    93   107</code></pre>
<p>Note that you could also achieve the same thing with <code>dplyr</code> functions. For example, you could use <code>mutate</code> with a logical statement to create an <code>is_male</code> column in the <code>nepali</code> dataframe, then group by the new <code>is_male</code> column and summarize, using the <code>n</code> function to count the number of observations in each group:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nepali %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">is_male =</span> sex ==<span class="st"> &quot;Male&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(is_male) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n_children =</span> <span class="kw">n</span>())</code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   is_male n_children
##     &lt;lgl&gt;      &lt;int&gt;
## 1   FALSE         93
## 2    TRUE        107</code></pre>
</div>
<div id="regression-models" class="section level2">
<h2><span class="header-section-number">3.5</span> Regression models</h2>
<div id="formula-structure" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Formula structure</h3>
<p><em>Regression models</em> can be used to estimate how the expected value of a <em>dependent variable</em> changes as <em>independent variables</em> change. </p>
<p>In R, regression formulas take this structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generic code
[response variable] ~<span class="st"> </span>[indep. var. <span class="dv">1</span>] +<span class="st">  </span>[indep. var. <span class="dv">2</span>] +<span class="st"> </span>...</code></pre></div>
<p>Notice that a tilde, <code>~</code>, is used to separate the independent and dependent variables and that a plus sign, <code>+</code>, is used to join independent variables. This format mimics the statistical notation:</p>
<p><span class="math display">\[
Y_i \sim X_1 + X_2 + X_3
\]</span></p>
<p>You will use this type of structure in R fo a lot of different function calls, including those for linear models (fit with the <code>lm</code> function) and generalized linear models (fit with the <code>glm</code> function).</p>
<p>There are some conventions that can be used in R formulas. Common ones include:</p>
<table style="width:97%;">
<colgroup>
<col width="18%" />
<col width="79%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Convention</th>
<th align="left">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><code>I()</code></td>
<td align="left">evaluate the formula inside <code>I()</code> before fitting (e.g., <code>I(x1 + x2)</code>)</td>
</tr>
<tr class="even">
<td align="center"><code>:</code></td>
<td align="left">fit the interaction between <code>x1</code> and <code>x2</code> variables</td>
</tr>
<tr class="odd">
<td align="center"><code>*</code></td>
<td align="left">fit the main effects and interaction for both variables (e.g., <code>x1*x2</code> equals <code>x1 + x2 + x1:x2</code>)</td>
</tr>
<tr class="even">
<td align="center"><code>.</code></td>
<td align="left">include as independent variables all variables other than the response (e.g., <code>y ~ .</code>)</td>
</tr>
<tr class="odd">
<td align="center"><code>1</code></td>
<td align="left">intercept (e.g., <code>y ~ 1</code> for an intercept-only model)</td>
</tr>
<tr class="even">
<td align="center"><code>-</code></td>
<td align="left">do not include a variable in the dataframe as an independent variables (e.g., <code>y ~ . - x1</code>); usually used in conjunction with <code>.</code> or <code>1</code></td>
</tr>
</tbody>
</table>
</div>
<div id="linear-models" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Linear models</h3>
<p>To fit a linear model, you can use the function <code>lm()</code>. This function is part of the <code>stats</code> package, which comes installed with base R. In this function, you can use the <code>data</code> option to specify the dataframe from which to get the vectors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_a &lt;-<span class="st"> </span><span class="kw">lm</span>(wt ~<span class="st"> </span>ht, <span class="dt">data =</span> nepali)</code></pre></div>
<p>This previous call fits the model:</p>
<p><span class="math display">\[ Y_{i} = \beta_{0} + \beta_{1}X_{1,i} + \epsilon_{i} \]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(Y_{i}\)</span> : weight of child <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(X_{1,i}\)</span> : height of child <span class="math inline">\(i\)</span></li>
</ul>
<p>If you run the <code>lm</code> function without saving it as an object, R will fit the regression and print out the function call and the estimated model coefficients:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(wt ~<span class="st"> </span>ht, <span class="dt">data =</span> nepali)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = wt ~ ht, data = nepali)
## 
## Coefficients:
## (Intercept)           ht  
##     -8.6948       0.2351</code></pre>
<p>However, to be able to use the model later for things like predictions and model assessments, you should save the output of the function as an R object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_a &lt;-<span class="st"> </span><span class="kw">lm</span>(wt ~<span class="st"> </span>ht, <span class="dt">data =</span> nepali)</code></pre></div>
<p>This object has a special class, <code>lm</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(mod_a)</code></pre></div>
<pre><code>## [1] &quot;lm&quot;</code></pre>
<p>This class is a special type of list object. If you use <code>is.list</code> to check, you can confirm that this object is a list:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.list</span>(mod_a)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>There are a number of functions that you can apply to an <code>lm</code> object. These include:</p>
<table>
<colgroup>
<col width="20%" />
<col width="79%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><code>summary</code></td>
<td align="left">Get a variety of information on the model, including coefficients and p-values for the coefficients</td>
</tr>
<tr class="even">
<td align="center"><code>coefficients</code></td>
<td align="left">Pull out just the coefficients for a model</td>
</tr>
<tr class="odd">
<td align="center"><code>fitted</code></td>
<td align="left">Get the fitted values from the model (for the data used to fit the model)</td>
</tr>
<tr class="even">
<td align="center"><code>plot</code></td>
<td align="left">Create plots to help assess model assumptions</td>
</tr>
<tr class="odd">
<td align="center"><code>residuals</code></td>
<td align="left">Get the model residuals</td>
</tr>
</tbody>
</table>
<p>For example, you can get the coefficients from the model by running:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coefficients</span>(mod_a)</code></pre></div>
<pre><code>## (Intercept)          ht 
##   -8.694768    0.235050</code></pre>
<p>The estimated coefficient for the intercept is always given under the name “(Intercept)”. Estimated coefficients for independent variables are given based on their column names in the original data (“ht” here, for <span class="math inline">\(\beta_1\)</span>, or the estimated increase in expected weight for a one unit increase in height).</p>
<p>You can use the output from a <code>coefficients</code> call to plot a regression line based on the model fit on top of points showing the original data (Figure <a href="exploring-data-1.html#fig:modelcoefplot">3.14</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_coef &lt;-<span class="st"> </span><span class="kw">coefficients</span>(mod_a)
<span class="kw">ggplot</span>(nepali, <span class="kw">aes</span>(<span class="dt">x =</span> ht, <span class="dt">y =</span> wt)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">0.2</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Height (cm)&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Weight (kg)&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="kw">aes</span>(<span class="dt">intercept =</span> mod_coef[<span class="dv">1</span>],
                  <span class="dt">slope =</span> mod_coef[<span class="dv">2</span>]), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:modelcoefplot"></span>
<img src="RProgrammingForResearch_files/figure-html/modelcoefplot-1.png" alt="Example of using the output from a coefficients call to add a regression line to a scatterplot." width="480" />
<p class="caption">
Figure 3.14: Example of using the output from a coefficients call to add a regression line to a scatterplot.
</p>
</div>
<div class="rmdnote">
<p>
You can also add a linear regression line to a scatterplot by adding the geom <code>geom_smooth</code> using the argument <code>method = “lm”</code>.
</p>
</div>
<p>You can use the function <code>residuals</code> on an <code>lm</code> object to pull out the residuals from the model fit:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">residuals</span>(mod_a))</code></pre></div>
<pre><code>##           1           2           3           4           5           6 
##  0.05820415 -0.82693141 -0.08223993  0.48644436 -0.46920621 -0.06405608</code></pre>
<p>The result of a <code>residuals</code> call is a vector with one element for each of the non-missing observations (rows) in the dataframe you used to fit the model. Each value gives the different between the model fitted value and the observed value for each of these observations, in the same order the observations show up in the dataframe. The residuals are in the same order as the observations in the original dataframe.</p>
<div class="rmdtip">
<p>
You can also use the shorter function <code>coef</code> as an alternative to <code>coefficients</code> and the shorter function <code>resid</code> as an alternative to <code>residuals</code>.
</p>
</div>
<p>As noted in the subsection on simple statistics functions, the <code>summary</code> function returns different output depending on the type of object that is input to the function. If you input a regression model object to <code>summary</code>, the function gives you a lot of information about the model. For example, here is the output returned by running <code>summary</code> for the linear regression model object we just created:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mod_a)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = wt ~ ht, data = nepali)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.44736 -0.55708  0.01925  0.49941  2.73594 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -8.694768   0.427398  -20.34   &lt;2e-16 ***
## ht           0.235050   0.005257   44.71   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9017 on 183 degrees of freedom
##   (15 observations deleted due to missingness)
## Multiple R-squared:  0.9161, Adjusted R-squared:  0.9157 
## F-statistic:  1999 on 1 and 183 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>This output includes a lot of useful elements, including (1) basic summary statistics for the residuals (to meet model assumptions, the median should be around zero and the absolute values fairly similar for the first and third quantiles), (2) coefficient estimates, standard errors, and p-values, and (3) some model summary statistics, including residual standard error, degrees of freedom, number of missing observations, and F-statistic.</p>
<p>The object returned by the <code>summary()</code> function when it is applied to an <code>lm</code> object is a list, which you can confirm using the <code>is.list</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.list</span>(<span class="kw">summary</span>(mod_a))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>With any list, you can use the <code>names</code> function to get the names of all of the different elements of the object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(<span class="kw">summary</span>(mod_a))</code></pre></div>
<pre><code>##  [1] &quot;call&quot;          &quot;terms&quot;         &quot;residuals&quot;     &quot;coefficients&quot; 
##  [5] &quot;aliased&quot;       &quot;sigma&quot;         &quot;df&quot;            &quot;r.squared&quot;    
##  [9] &quot;adj.r.squared&quot; &quot;fstatistic&quot;    &quot;cov.unscaled&quot;  &quot;na.action&quot;</code></pre>
<p>You can use the <code>$</code> operator to pull out any element of the list. For example, to pull out the table with information on the estimated model coefficients, you can run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mod_a)$coefficients</code></pre></div>
<pre><code>##              Estimate  Std. Error   t value      Pr(&gt;|t|)
## (Intercept) -8.694768 0.427397843 -20.34350  7.424640e-49
## ht           0.235050 0.005256822  44.71334 1.962647e-100</code></pre>
<p>The <code>plot</code> function, like the <code>summary</code> function, will give different output depending on the class of the object that you input. For an <code>lm</code> object, you can use the <code>plot</code> function to get a number of useful diagnostic plots that will help you check regression assumptions (Figure <a href="exploring-data-1.html#fig:plotlmexample">3.15</a>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mod_a)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plotlmexample"></span>
<img src="RProgrammingForResearch_files/figure-html/plotlmexample-1.png" alt="Example output from running the plot function with an lm object as the input." width="\textwidth" />
<p class="caption">
Figure 3.15: Example output from running the plot function with an lm object as the input.
</p>
</div>
<p>You can also use binary variables or factors as independent variables in regression models. For example, in the <code>nepali</code> dataset, <code>sex</code> is a factor variable with the levels “Male” and “Female”. You can fit a linear model of weight regressed on sex for this data with the call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_b &lt;-<span class="st"> </span><span class="kw">lm</span>(wt ~<span class="st"> </span>sex, <span class="dt">data =</span> nepali)</code></pre></div>
<p>This call fits the model:</p>
<p><span class="math display">\[ Y_{i} = \beta_{0} + \beta_{1}X_{1,i} + \epsilon_{i} \]</span></p>
<p>where <span class="math inline">\(X_{1,i}\)</span> : sex of child <span class="math inline">\(i\)</span>, where 0 = male and 1 = female.</p>
<p>Here are the estimated coefficients from fitting this model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mod_b)$coefficients</code></pre></div>
<pre><code>##              Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 10.497980  0.3110957 33.745177 1.704550e-80
## sexFemale   -0.674724  0.4562792 -1.478752 1.409257e-01</code></pre>
<p>You’ll notice that, in addition to an estimated intercept (<code>(Intercept)</code>), the other estimated coefficient is <code>sexFemale</code> rather than just <code>sex</code>, although the column name in the dataframe input to <code>lm</code> for this variable is <code>sex</code>.</p>
<p>This is because, when a factor or binary variable is input as an independent variable in a linear regression model, R will fit an estimated coefficient for all levels of factors <em>except</em> the first factor level. By default, this first factor level is used as the baseline level, and so its estimated mean is given by the estimated intercept, while the other model coefficients give the estimated <em>difference</em> from this baseline.</p>
<p>For example, the model fit above tells us that the estimated mean weight of males is 10.5, while the estimated mean weight of females is 10.5 + -0.7 = 9.8.</p>
<p>If you would prefer that a different level of the factor be the baseline (for example, “Female” rather than “Male” for the previous regression), you can do that by using the <code>levels</code> argument in the <code>factor</code> function to reset factor levels. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nepali_reset &lt;-<span class="st"> </span>nepali %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">factor</span>(sex, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>)))
mod_b_reset &lt;-<span class="st"> </span><span class="kw">lm</span>(wt ~<span class="st"> </span>sex, <span class="dt">data =</span> nepali_reset)
<span class="kw">summary</span>(mod_b_reset)$coef</code></pre></div>
<pre><code>##             Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 9.823256  0.3337816 29.430189 2.626719e-71
## sexMale     0.674724  0.4562792  1.478752 1.409257e-01</code></pre>
<p>Now, <code>(Intercept)</code> gives the estimated mean weight for females, while the second estimated coefficient gives the estimated mean difference for males compared to the expected value for females.</p>
</div>
<div id="generalized-linear-models-glms" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Generalized linear models (GLMs)</h3>
<p>You can fit a variety of models, including linear models, logistic models, and Poisson models, using generalized linear models (GLMs). </p>
<p>For linear models, the only difference between <code>lm</code> and <code>glm</code> are the mechanics of how they estimate the model coefficients (<code>lm</code> uses least squares while <code>glm</code> uses maximum likelihood). You will (almost always) get exactly the same estimated coefficients regardless of whether you use <code>glm</code> or <code>lm</code> to fit a linear regression.</p>
<p>For example, here is the code to fit a linear regression model for weight regressed on height from the <code>nepali</code> dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_c &lt;-<span class="st"> </span><span class="kw">glm</span>(wt ~<span class="st"> </span>ht, <span class="dt">data =</span> nepali)</code></pre></div>
<p>This call fits the same regression model I fit earlier with the <code>lm</code> function and saved as <code>mod_a</code>. You can see that the two methods give exactly the same coefficient estimates:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(mod_c)</code></pre></div>
<pre><code>## (Intercept)          ht 
##   -8.694768    0.235050</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(mod_a)</code></pre></div>
<pre><code>## (Intercept)          ht 
##   -8.694768    0.235050</code></pre>
<p>Unlike the <code>lm</code> function, however, the <code>glm</code> function also allows you to fit other model types, including logistic and Poisson models. You can specify the model type using the <code>family</code> argument to the <code>glm</code> call:</p>
<table>
<thead>
<tr class="header">
<th align="left">Model type</th>
<th align="left"><code>family</code> argument</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Linear</td>
<td align="left"><code>family = gaussian(link = 'identity')</code></td>
</tr>
<tr class="even">
<td align="left">Logistic</td>
<td align="left"><code>family = binomial(link = 'logit')</code></td>
</tr>
<tr class="odd">
<td align="left">Poisson</td>
<td align="left"><code>family = poisson(link = 'log')</code></td>
</tr>
</tbody>
</table>
<p>For example, say we wanted to fit a logistic regression for the <code>nepali</code> data of whether the probability of a child weighing more than 13 kg is associated with the child’s sex.</p>
<p>First, create a binary variable in the <code>nepali</code> dataset, <code>wt_over_13</code>, that is <code>TRUE</code> if a child weighed more than 13 kilograms and FALSE otherwise. You can use the <code>mutate</code> function from <code>dplyr</code> to add this new column (which, as a note, is a logical vector):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nepali &lt;-<span class="st"> </span>nepali %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">wt_over_13 =</span> wt &gt;<span class="st"> </span><span class="dv">13</span>)
<span class="kw">head</span>(nepali)</code></pre></div>
<pre><code>##       id    sex   wt    ht age wt_over_13
## 1 120011   Male 12.8  91.2  41      FALSE
## 2 120012 Female 14.9 103.9  57       TRUE
## 3 120021 Female  7.7  70.1   8      FALSE
## 4 120022 Female 12.1  86.4  35      FALSE
## 5 120023   Male 14.2  99.4  49       TRUE
## 6 120031   Male 13.9  96.4  46       TRUE</code></pre>
<p>Now you can fit a logistic regression of <code>wt_over_13</code> regressed on sex, using a logistic model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_d &lt;-<span class="st"> </span><span class="kw">glm</span>(wt_over_13 ~<span class="st"> </span>sex, <span class="dt">data =</span> nepali,
             <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</code></pre></div>
<p>Elements of a GLM can be pulled out in the same way that we looked at elements from the linear model fit with <code>lm</code>. For example, to see a table of estimated model coefficients, you can run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mod_d)$coef</code></pre></div>
<pre><code>##               Estimate Std. Error   z value     Pr(&gt;|z|)
## (Intercept) -1.3121864  0.2458445 -5.337465 9.425485e-08
## sexFemale   -0.4133237  0.3886659 -1.063442 2.875815e-01</code></pre>
<p>Because this model was a logistic model, fit with a log link, here the model coefficient estimate for <code>sexFemale</code> gives an estimate of the <strong>log odds</strong> of weight higher than 13 kg associated with females versus males. The p-value for this estimate (<code>Pr(&gt;|z|)</code> = 0.29) isn’t very small, suggesting that the difference between male and female children in the odds of weighing more than 13 kg is not statistically significant.</p>
</div>
<div id="references-statistics-in-r" class="section level3">
<h3><span class="header-section-number">3.5.4</span> References– statistics in R</h3>
<p>One great (and free online for CSU students through our library) book to find out more about using R for basic statistics is:</p>
<ul>
<li><a href="http://discovery.library.colostate.edu/Record/.b44705323">Introductory Statistics with R</a></li>
</ul>
<p>If you want all the details about fitting linear models and GLMs in R, Julian Faraway’s books are fantastic. He has one on linear models and one on extensions including logistic and Poisson models:</p>
<ul>
<li><a href="http://discovery.library.colostate.edu/Record/.b41119691">Linear Models with R</a> (also free online through the CSU library)</li>
<li><a href="http://www.amazon.com/Extending-Linear-Model-Generalized-Nonparametric/dp/158488424X/ref=sr_1_1?ie=UTF8&amp;qid=1442252668&amp;sr=8-1&amp;keywords=extending+linear+model+r">Extending the Linear Model with R</a></li>
</ul>
</div>
</div>
<div id="in-course-exercise-2" class="section level2">
<h2><span class="header-section-number">3.6</span> In-course exercise</h2>
<div id="loading-data-from-an-r-package" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Loading data from an R package</h3>
<p>The data we’ll be using today is from a dataset called <code>worldcup</code> in the package <code>faraway</code>. Load that data so you can use it on your computer (note: you will need to load and install the <code>faraway</code> package to do this). Use the help file for the data to find out more about the dataset. Use some basic functions, like <code>head</code>, <code>tail</code>, <code>colnames</code>, <code>str</code>, and <code>summary</code> to check out the data a bit. See if you can figure out:</p>
<ul>
<li>What variables are included in this dataset? (Check the column names.)</li>
<li>What class is each column currently? In particular, which are numbers and which are factors?</li>
</ul>
<div id="example-r-code" class="section level4">
<h4><span class="header-section-number">3.6.1.1</span> Example R code:</h4>
<p>Load the <code>faraway</code> package using <code>load()</code> and then load the data using <code>data()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Uncomment the next line if you need to install the package
<span class="co"># install.packages(&quot;faraway&quot;)</span>
<span class="kw">library</span>(faraway)
<span class="kw">data</span>(<span class="st">&quot;worldcup&quot;</span>)</code></pre></div>
<p>Check out the help file for the <code>worldcup</code> dataset to find out more about the data. (Note: Only datasets that are parts of packages will have help files.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?worldcup</code></pre></div>
<p>Check out the data a bit:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(worldcup)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    595 obs. of  7 variables:
##  $ Team    : Factor w/ 32 levels &quot;Algeria&quot;,&quot;Argentina&quot;,..: 1 16 9 9 5 32 11 11 18 20 ...
##  $ Position: Factor w/ 4 levels &quot;Defender&quot;,&quot;Forward&quot;,..: 4 4 1 4 2 2 1 2 4 1 ...
##  $ Time    : int  16 351 180 270 46 72 138 33 21 103 ...
##  $ Shots   : int  0 0 0 1 2 0 0 0 5 0 ...
##  $ Passes  : int  6 101 91 111 16 15 51 9 22 38 ...
##  $ Tackles : int  0 14 6 5 0 0 2 0 0 1 ...
##  $ Saves   : int  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(worldcup)</code></pre></div>
<pre><code>##                Team   Position Time Shots Passes Tackles Saves
## Abdoun      Algeria Midfielder   16     0      6       0     0
## Abe           Japan Midfielder  351     0    101      14     0
## Abidal       France   Defender  180     0     91       6     0
## Abou Diaby   France Midfielder  270     1    111       5     0
## Aboubakar  Cameroon    Forward   46     2     16       0     0
## Abreu       Uruguay    Forward   72     0     15       0     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(worldcup)</code></pre></div>
<pre><code>##                        Team   Position Time Shots Passes Tackles Saves
## van Bommel      Netherlands Midfielder  540     2    307      31     0
## van Bronckhorst Netherlands   Defender  540     1    271      10     0
## van Persie      Netherlands    Forward  479    14    108       1     0
## von Bergen      Switzerland   Defender  234     0     79       3     0
## Alvaro Pereira      Uruguay Midfielder  409     6    140      17     0
## Ozil                Germany Midfielder  497     7    266       3     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(worldcup)</code></pre></div>
<pre><code>## [1] &quot;Team&quot;     &quot;Position&quot; &quot;Time&quot;     &quot;Shots&quot;    &quot;Passes&quot;   &quot;Tackles&quot; 
## [7] &quot;Saves&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(worldcup)</code></pre></div>
<pre><code>##         Team           Position        Time           Shots       
##  Slovakia : 21   Defender  :188   Min.   :  1.0   Min.   : 0.000  
##  Uruguay  : 21   Forward   :143   1st Qu.: 88.0   1st Qu.: 0.000  
##  Argentina: 20   Goalkeeper: 36   Median :191.0   Median : 1.000  
##  Cameroon : 20   Midfielder:228   Mean   :208.9   Mean   : 2.304  
##  Chile    : 20                    3rd Qu.:270.0   3rd Qu.: 3.000  
##  Paraguay : 20                    Max.   :570.0   Max.   :27.000  
##  (Other)  :473                                                    
##      Passes          Tackles           Saves        
##  Min.   :  0.00   Min.   : 0.000   Min.   : 0.0000  
##  1st Qu.: 29.00   1st Qu.: 1.000   1st Qu.: 0.0000  
##  Median : 61.00   Median : 3.000   Median : 0.0000  
##  Mean   : 84.52   Mean   : 4.192   Mean   : 0.6672  
##  3rd Qu.:115.50   3rd Qu.: 6.000   3rd Qu.: 0.0000  
##  Max.   :563.00   Max.   :34.000   Max.   :20.0000  
## </code></pre>
</div>
</div>
<div id="basic-plots-of-the-data" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Basic plots of the data</h3>
<p>Use some basic plots to check out this data. Try the following:</p>
<ul>
<li>Plot histograms of all the numeric variables (<code>Time</code>, <code>Shot</code>, <code>Passes</code>, <code>Tackles</code>, <code>Saves</code>)</li>
<li>Plot scatterplots of different combinations of numeric variables (e.g., <code>Time</code> vs. <code>Shots</code>). Try doing this using the <code>geom_point()</code> geom from <code>ggplot2</code>. Also try doing it using the <code>ggpairs()</code> function from the <code>GGally</code> package, to plot several of these at the same time. Try using different constant or mapped values with the <code>color</code> aesthetic.</li>
<li>Create boxplots of <code>Time</code>, <code>Shots</code>, <code>Passes</code> and <code>Saves</code> by position.</li>
<li>Go online and find out which teams were the top four teams in this World Cup (i.e., first through fourth places). Create a <code>top_teams</code> subset with just these teams. Plot boxplots of <code>Shots</code> and <code>Saves</code> by team for just these teams.</li>
<li>Did you notice any interesting features of the data when you did any of the graphs in this section?</li>
</ul>
<div id="example-r-code-1" class="section level4">
<h4><span class="header-section-number">3.6.2.1</span> Example R code:</h4>
<p>Use histograms to explore the distribution of different variables. If you want to change the number of bins in the histogram, try playing around with the <code>bins</code> and <code>binwidth</code> arguments. You can use the <code>bins</code> argument to say how many bins you want (e.g., <code>bins = 50</code>). You can use the <code>binwidth</code> argument to say how wide you want the bins to be (e.g., <code>binwidth = 10</code> if you wanted bins to be 10 units wide, in the units of the variable mapped to the <code>x</code> aesthetic. Try using <code>fill</code> and <code>color</code> to change the appearance of the plot. Google “R colors” and search the images to find links to listings of different R colors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(worldcup, <span class="kw">aes</span>(<span class="dt">x =</span> Time)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>()</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-191-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(worldcup, <span class="kw">aes</span>(<span class="dt">x =</span> Time)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">50</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-191-2.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(worldcup, <span class="kw">aes</span>(<span class="dt">x =</span> Time)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">100</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-191-3.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(worldcup, <span class="kw">aes</span>(<span class="dt">x =</span> Time)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">50</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;cyan4&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-191-4.png" width="480" style="display: block; margin: auto;" /></p>
<p>Create a scatterplot of <code>Time</code> versus <code>Passes</code>. To change the size of the points, use the <code>size</code> argument (use a number lower than 1 for smaller points, higher than 1 for larger points). Try changing the color and transparency of the points using the aesthetics <code>color</code> and <code>alpha</code>. Try using color to show each player’s position by mapping <code>Position</code> to the <code>color</code> aesthetic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(worldcup, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Passes)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-192-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(worldcup, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Passes)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-192-2.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(worldcup, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Passes)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.25</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-192-3.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(worldcup, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Passes, <span class="dt">color =</span> Position)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-192-4.png" width="480" style="display: block; margin: auto;" /></p>
<p>Use the <code>ggpairs</code> function from the <code>GGally</code> package to plot scatterplots of all combinations of several numeric variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)
<span class="kw">library</span>(dplyr)
<span class="kw">ggpairs</span>(<span class="kw">select</span>(worldcup, Time, Shots, Passes, Tackles, Saves))</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-193-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To create a boxplot of <code>Shots</code> by <code>Position</code>, you can use <code>geom_boxplot</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(worldcup, <span class="kw">aes</span>(<span class="dt">x =</span> Position, <span class="dt">y =</span> Shots)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-194-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The top four teams in this World Cup were Spain, the Netherlands, Germany, and Uruguay. Create a subset with just the data for these four teams:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">top_teams &lt;-<span class="st"> </span>worldcup %&gt;%
<span class="st">  </span><span class="kw">filter</span>(Team %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Spain&quot;</span>, <span class="st">&quot;Netherlands&quot;</span>, <span class="st">&quot;Germany&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Team =</span> <span class="kw">factor</span>(Team))</code></pre></div>
<p>This dataset will still have all the levels saved for the <code>Team</code> factor, even though it isn’t using them all. You can re-set this by resetting <code>Team</code> as a factor, which is what I’ve done with the <code>mutate</code> line. When R creates a factor from a vector, its default is to only use as levels the values that show up in the vector.</p>
<p>Now, you can plot the boxplots, mapping <code>Team</code> to the <code>x</code> aesthetic and <code>Shots</code> or <code>Saves</code> to the <code>y</code> aesthetic:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(top_teams, <span class="kw">aes</span>(<span class="dt">x =</span> Team, <span class="dt">y =</span> Shots)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Shots&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-196-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(top_teams, <span class="kw">aes</span>(<span class="dt">x =</span> Team, <span class="dt">y =</span> Saves)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Saves&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-196-2.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="if-you-have-extra-time" class="section level4">
<h4><span class="header-section-number">3.6.2.2</span> If you have extra time:</h4>
<p>If you wanted to do the same plot for several different variables, you could loop through your code (we’ll be covering more about loops in a few weeks). For example, you could create histograms for all of the numeric variables (if you do this in RStudio, you’ll need to use the arrows on the plot window to move through and see all the different plots once you’ve created them):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Create an object with the column names for all of the numeric variables
my_vars &lt;-<span class="st"> </span><span class="kw">colnames</span>(worldcup)[<span class="dv">3</span>:<span class="dv">7</span>]

## Loop through all of those variables. Print out a histogram with the 
## variable, and have it print on the plot, as the main title, the 
## column name for that variable
for(var in my_vars){
  worldcup$to_plot &lt;-<span class="st"> </span>worldcup[ , var]
  a &lt;-<span class="st"> </span><span class="kw">ggplot</span>(worldcup, <span class="kw">aes</span>(<span class="dt">x =</span> to_plot)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">20</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;navy&quot;</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">xlab</span>(var) +<span class="st"> </span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste</span>(<span class="st">&quot;Histogram of&quot;</span>, var))
  <span class="kw">plot</span>(a)
}</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-197-1.png" width="288" /><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-197-2.png" width="288" /><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-197-3.png" width="288" /><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-197-4.png" width="288" /><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-197-5.png" width="288" /></p>
<p>A few things to note in this example:</p>
<ul>
<li>To map an element of the data to an aesthetic, it’s easiest if that element is saved in a column in the dataframe. Within this loop, I’m making an extra column called <code>to_plot</code>, where I’m copying the column of the variable I want to plot each time the loop runs. That way, I can always use <code>x = to_plot</code> in the aesthetic mapping for the ggplot object.</li>
<li>If you run code to create a ggplot object within a loop, it won’t automatically print. Instead, you need to use <code>print</code> to get the object to print out. One way to do that is to save the final ggplot object as an R object (here I’m saving it to <code>a</code>) and then use the <code>print</code> function to print that object.</li>
<li>Next week, we’ll talk some about faceting, which can create multiple plots by variable like this in a lot less code. However, it’s useful at this point to start thinking about how to extend code to use in loops, to save yourself time when you need to repeat something similar many times.</li>
</ul>
</div>
</div>
<div id="exploring-the-data-using-simple-statistics-and-logical-statements" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Exploring the data using simple statistics and logical statements</h3>
<p>Next, try checking out the data using some basic commands for simple statistics, like <code>mean()</code>, <code>range()</code>, <code>max()</code>, and <code>min()</code>. Use these, along with some logical statements, to help you answer the following questions:</p>
<ul>
<li>What is the range of time that players spent in the game? Who played the most World Cup time in this World Cup? For the minimum of the range of <code>Time</code>, how many players played this amount of time?</li>
<li>What is the mean number of saves that players made? What is the mean number of saves just among the goalkeepers? How many of the players are goalkeepers? Did any non-goalkeeper make a save?</li>
</ul>
<div id="example-r-code-2" class="section level4">
<h4><span class="header-section-number">3.6.3.1</span> Example R code:</h4>
<p>Use <code>range()</code> to find out the range of time these players played in the World Cup.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(worldcup$Time)</code></pre></div>
<pre><code>## [1]   1 570</code></pre>
<p>To figure out who played the most time, you need to subset out the rows of the dataset where the <code>Time</code> variable equals the maximum of the <code>Time</code> variable for the whole dataset. There are a few ways to do that. Here I’m showing two: (1) using logic within the “square-bracket indexing”, to pull out just rows where it is TRUE that the <code>Time</code> for that row equals <code>max(worldcup$Time)</code> and (2) using <code>filter</code> from the <code>dplyr</code> package to filter down to rows where where it is TRUE that the <code>Time</code> for that row equals <code>max(Time)</code> for the whole dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(worldcup$Time)</code></pre></div>
<pre><code>## [1] 570</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(worldcup$Time ==<span class="st"> </span><span class="kw">max</span>(worldcup$Time))</code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcup[worldcup$Time ==<span class="st"> </span><span class="kw">max</span>(worldcup$Time), ]</code></pre></div>
<pre><code>##                 Team   Position Time Shots Passes Tackles Saves to_plot
## Arevalo Rios Uruguay Midfielder  570     5    195      21     0       0
## Maxi Pereira Uruguay Midfielder  570     5    182      15     0       0
## Muslera      Uruguay Goalkeeper  570     0     75       0    16      16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcup %&gt;%
<span class="st">  </span><span class="kw">filter</span>(Time ==<span class="st"> </span><span class="kw">max</span>(Time))</code></pre></div>
<pre><code>##      Team   Position Time Shots Passes Tackles Saves to_plot
## 1 Uruguay Midfielder  570     5    195      21     0       0
## 2 Uruguay Midfielder  570     5    182      15     0       0
## 3 Uruguay Goalkeeper  570     0     75       0    16      16</code></pre>
<p><em>Note</em>: You may have noticed that you lost the players names when you did this using the <code>dplyr</code> pipechain. That’s because <code>dplyr</code> functions convert the data to a dataframe format that does not include rownames. If you want to keep players’ names, use <code>mutate</code> to move those names from the rownames of the data into a column in the dataframe:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcup %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Name =</span> <span class="kw">rownames</span>(worldcup)) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(Time ==<span class="st"> </span><span class="kw">max</span>(Time))</code></pre></div>
<pre><code>##      Team   Position Time Shots Passes Tackles Saves to_plot         Name
## 1 Uruguay Midfielder  570     5    195      21     0       0 Arevalo Rios
## 2 Uruguay Midfielder  570     5    182      15     0       0 Maxi Pereira
## 3 Uruguay Goalkeeper  570     0     75       0    16      16      Muslera</code></pre>
<p>To calculate the mean number of saves among all the players, use the <code>mean</code> function, either by itself or within a <code>summarize</code> call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(worldcup$Saves)</code></pre></div>
<pre><code>## [1] 0.6672269</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcup %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_saves =</span> <span class="kw">mean</span>(Saves))</code></pre></div>
<pre><code>##   mean_saves
## 1  0.6672269</code></pre>
<p>For the next parts of the question, it will be convenient to have a logical vector for whether each player is a goalkeeper, so here’s how you would create that:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">goalie &lt;-<span class="st"> </span>worldcup$Position ==<span class="st"> &quot;Goalkeeper&quot;</span></code></pre></div>
<p>This new object, <code>goalie</code>, is a vector the same length as <code>worldcup$Position</code>. Each element of <code>goalie</code> says whether it is TRUE or FALSE that <code>worldcup$Position</code> is equal to “Goalkeeper” at that spot on the <code>worldcup$Position</code> vector.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(goalie)</code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>The <code>summary()</code> function will count up the total number of times that <code>goalie</code> is TRUE and FALSE.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(goalie)</code></pre></div>
<pre><code>##    Mode   FALSE    TRUE    NA&#39;s 
## logical     559      36       0</code></pre>
<p>There are a few ways to use this vector to figure out how many players were goalkeepers. First, you could use <code>summary</code> (which I just showed) or <code>table</code>, and just read how many times this vector has the value <code>TRUE</code>. Second, since R saves logical vectors with <code>TRUE</code> as 1 and <code>FALSE</code> as 0, you could just the <code>sum</code> function to add up the vector to find out how often it’s <code>TRUE</code> (<code>sum</code> adds up every value in the vector).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(goalie)</code></pre></div>
<pre><code>## goalie
## FALSE  TRUE 
##   559    36</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(goalie)</code></pre></div>
<pre><code>## [1] 36</code></pre>
<p>You could also answer this question by using <code>summarize</code> from <code>dplyr</code>. You need to <code>group_by</code> player position and then you can use the <code>n</code> function in <code>summarize</code> to count up the total number of observations in each group:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcup %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(Position) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n_players =</span> <span class="kw">n</span>())</code></pre></div>
<pre><code>## # A tibble: 4 × 2
##     Position n_players
##       &lt;fctr&gt;     &lt;int&gt;
## 1   Defender       188
## 2    Forward       143
## 3 Goalkeeper        36
## 4 Midfielder       228</code></pre>
<p>Now, you can answer the questions about mean saves for goalies and max saves for non-goalies. First, try doing that using the <code>goalie</code> logical vector you created. If you put <code>goalie</code> in the square bracket indexing for the dataframe as the rows value (i.e., the index before the comma), R will subset out just the rows where <code>goalie</code> is equal to TRUE. If you put <code>!goalie</code> in the square bracket indexing as the rows value, R will just subset out the rows where <code>goalie</code> is equal to FALSE. You can use this index subsetting to figure out the mean number of saves per goalie and also whether any non-goalie made a save (by checking the maximum value or range of saves for non-goalies).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(worldcup[goalie, ])</code></pre></div>
<pre><code>##                 Team   Position Time Shots Passes Tackles Saves to_plot
## Barry    Ivory Coast Goalkeeper  270     0     23       0     8       8
## Benaglio Switzerland Goalkeeper  270     0     75       0    11      11
## Bravo          Chile Goalkeeper  360     0     58       0     4       4
## Buffon         Italy Goalkeeper   45     0      4       0     0       0
## Casillas       Spain Goalkeeper  540     0     67       0    11      11
## Chaouchi     Algeria Goalkeeper   90     0     17       0     2       2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(worldcup[goalie, <span class="st">&quot;Saves&quot;</span>])</code></pre></div>
<pre><code>## [1] 11.02778</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(worldcup[!goalie, <span class="st">&quot;Saves&quot;</span>])</code></pre></div>
<pre><code>## [1] 0 0</code></pre>
<p>You could also answer this quesiton using a <code>dplyr</code> pipe chain to summarize the data after grouping it by position:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">worldcup %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(Position) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">number_players =</span> <span class="kw">n</span>(), 
            <span class="dt">mean_saves =</span> <span class="kw">mean</span>(Saves),
            <span class="dt">max_saves =</span> <span class="kw">max</span>(Saves))</code></pre></div>
<pre><code>## # A tibble: 4 × 4
##     Position number_players mean_saves max_saves
##       &lt;fctr&gt;          &lt;int&gt;      &lt;dbl&gt;     &lt;int&gt;
## 1   Defender            188    0.00000         0
## 2    Forward            143    0.00000         0
## 3 Goalkeeper             36   11.02778        20
## 4 Midfielder            228    0.00000         0</code></pre>
</div>
</div>
<div id="using-regression-models-to-explore-data" class="section level3">
<h3><span class="header-section-number">3.6.4</span> Using regression models to explore data</h3>
<p>For this part of the exercise, you’ll use a dataset on weather, air pollution, and mortality counts in Chicago, IL. This dataset is called <code>chicagoNMMAPS</code> and is part of the <code>dlnm</code> package. Change the name of the dataframe to something shorter, like <code>chic</code>. Check out the data a bit to see what variables you have, and then perform the following tasks:</p>
<ul>
<li>Write out (on paper, not in R) the regression equation for regressing dewpoint temperature on temperature.</li>
<li>Try fitting a linear regression of dew point temperature (<code>dptp</code>) on temperature (<code>temp</code>). (Bonus points: Notice anything that seems unusual about these two variables in this dataset? You can find out with <code>summary</code>, but it helps if you know a bit about what dewpoint temperature measures.) Save this model as the object <code>mod_1</code>.</li>
<li>Based on this regression, does there seem to be a relationship between temperature and dewpoint temperature in Chicago? (Hint: Try using <code>summary()</code> on the model object to get more information about the model you fit.) What is the p-value for the coefficient for temperature?</li>
<li>Plot temperature (x-axis) versus dewpoint temperature (y-axis) for Chicago. Add in the regression line from the model you fit.</li>
<li>Use <code>plot()</code> on the model object to check if some of the assumptions for the regression model seem appropriate.</li>
<li>Try fitting the regression as a GLM, using <code>glm()</code>. Are your coefficients different?</li>
<li>Does <span class="math inline">\(PM_{10}\)</span> vary by day of the week? (Hint: The <code>dow</code> variable is a factor that gives day of the week. You can do an ANOVA analysis by fitting a linear model using this variable as the independent variable, and then run <code>anova()</code> on that model, and R will compare it to an intercept-only model.) What day of the week is PM10 generally highest? (Check the model coefficients to figure this out.) Try to write out (on paper) the regression equation for the model you’re fitting.</li>
<li>Try using <code>glm()</code> to run a Poisson regression of respiratory deaths (<code>resp</code>) on temperature during summer days. Start by creating a subset with just summer days called <code>summer</code>. (Hint: Use the <code>month</code> variable to do this– just pull out the subset where the month is 6, 7, or 8, for June, July, and August.) Try to write out the regression equation for the model you’re fitting.</li>
<li>The coefficient for the temperature variable in this model is our best estimate (based on this model) of the <strong>log relative risk</strong> for a one degree Celcius increase in temperature. What is the <strong>relative risk</strong> associated with a one degree Celsius increase?</li>
</ul>
<div id="example-r-code-3" class="section level4">
<h4><span class="header-section-number">3.6.4.1</span> Example R code:</h4>
<p>Install and load the <code>dlnm</code> package and then load the <code>chicagoNMMAPS</code> data. Change the name of the dataframe to <code>chic</code>, so it will be shorter to call for the rest of your work.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages(&quot;dlnm&quot;)</span>
<span class="kw">library</span>(dlnm)
<span class="kw">data</span>(<span class="st">&quot;chicagoNMMAPS&quot;</span>)
chic &lt;-<span class="st"> </span>chicagoNMMAPS</code></pre></div>
<p>Fit a linear regression of <code>dptp</code> on <code>temp</code> and save as the object <code>mod_1</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dptp ~<span class="st"> </span>temp, <span class="dt">data =</span> chic)
mod_1</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dptp ~ temp, data = chic)
## 
## Coefficients:
## (Intercept)         temp  
##      24.025        1.621</code></pre>
<p>Use <code>summary()</code> to check out a bit more about the model you fit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mod_1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dptp ~ temp, data = chic)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -24.3093  -3.7470   0.4687   4.0738  18.6518 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 24.024869   0.112933   212.7   &lt;2e-16 ***
## temp         1.620650   0.007631   212.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.899 on 5112 degrees of freedom
## Multiple R-squared:  0.8982, Adjusted R-squared:  0.8982 
## F-statistic: 4.511e+04 on 1 and 5112 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>There does seem to be an association between temperature and dewpoint temperature: a unit increase in temperature is associated with a 1.6 unit increase in dewpoint temperature. The p-value for the temperature coefficient is &lt;2e-16. This is far below 0.05, which suggests we would be very unlikely to see such a strong association by chance if the null hypothesis, that the two variables are not associated, were true.</p>
<p>Plot these two variables and add in the regression line from the model (note: I’ve used the <code>color</code> option to make the color of the points gray). Use the values from <code>coef</code> with a <code>geom_abline</code> to add the regression line for the model you fit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_coefs &lt;-<span class="st"> </span><span class="kw">coef</span>(mod_1)
<span class="kw">ggplot</span>(chic, <span class="kw">aes</span>(<span class="dt">x =</span> temp, <span class="dt">y =</span> dptp)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="kw">aes</span>(<span class="dt">intercept =</span> mod_coefs[<span class="dv">1</span>], <span class="dt">slope =</span> mod_coefs[<span class="dv">2</span>]))</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-212-1.png" width="672" /></p>
<p>Plot some plots to check model assumptions for the model you fit using the <code>plot()</code> function on your model object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)) <span class="co"># Set to four plots per panel -- 2 rows, 2 columns</span>
<span class="kw">plot</span>(mod_1)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-213-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># Reset to one plot per panel</span></code></pre></div>
<p>Try fitting the model using <code>glm()</code>. Call it <code>mod_1a</code>. Compare the coefficients for the two models. You can use the <code>coef()</code> function on an <code>lm</code> or <code>glm</code> object to pull out just the model coefficients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_1a &lt;-<span class="st"> </span><span class="kw">glm</span>(dptp ~<span class="st"> </span>temp, <span class="dt">data =</span> chic)

<span class="kw">coef</span>(mod_1)</code></pre></div>
<pre><code>## (Intercept)        temp 
##    24.02487     1.62065</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(mod_1a)</code></pre></div>
<pre><code>## (Intercept)        temp 
##    24.02487     1.62065</code></pre>
<p>The results from the two models are identical.</p>
<p>Fit a model of <span class="math inline">\(PM_{10}\)</span> regressed on day of week, where day of week is a factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_2 &lt;-<span class="st"> </span><span class="kw">lm</span>(pm10 ~<span class="st"> </span>dow, <span class="dt">data =</span> chic)
<span class="kw">summary</span>(mod_2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pm10 ~ dow, data = chic)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -39.05 -12.55  -3.34   8.80 328.66 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   27.5217     0.7303  37.684  &lt; 2e-16 ***
## dowMonday      6.1322     1.0340   5.931 3.22e-09 ***
## dowTuesday     6.7954     1.0269   6.617 4.05e-11 ***
## dowWednesday   8.4768     1.0262   8.261  &lt; 2e-16 ***
## dowThursday    8.8047     1.0240   8.598  &lt; 2e-16 ***
## dowFriday      9.4816     1.0262   9.240  &lt; 2e-16 ***
## dowSaturday    3.6602     1.0269   3.564 0.000368 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.07 on 4856 degrees of freedom
##   (251 observations deleted due to missingness)
## Multiple R-squared:  0.02588,    Adjusted R-squared:  0.02467 
## F-statistic:  21.5 on 6 and 4856 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Use the <code>anova()</code> command to compare this model to a model with only an intercept (i.e., one that only fits a global mean and uses that as the expected value for all of the observations).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(mod_2)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: pm10
##             Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## dow          6   46924  7820.6    21.5 &lt; 2.2e-16 ***
## Residuals 4856 1766407   363.8                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The p-value for an ANOVA of the model with day-of-week coefficients versus the model that just has an intercept is &lt; 2.2e-16. This is well below 0.05, which suggests that day-of-week is associated with PM10 concentration, as a model that includes day-of-week does a much better job of explaining variation in PM10 than a model without it does. (Note, too, that the F value and Pr(&gt;F) for the <code>anova()</code> call are identical to the F-statistic information given in the <code>summary()</code> of the model object. This will always be true when you’re using <code>anova()</code> to compare a model to a model with just an intercept.)</p>
<p>Use a boxplot to visually compare PM10 by day of week.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(chic, <span class="kw">aes</span>(<span class="dt">x =</span> dow, <span class="dt">y =</span> pm10)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-217-1.png" width="576" /></p>
<p>Now try the same plot, but try using the <code>ylim =</code> option to change the limits on the y-axis for the graph, so you can get a better idea of the pattern by day of week (some of the extreme values are very high, which makes it hard to compare by eye when the y-axis extends to include them all).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(chic, <span class="kw">aes</span>(<span class="dt">x =</span> dow, <span class="dt">y =</span> pm10)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</code></pre></div>
<pre><code>## Warning: Removed 292 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="RProgrammingForResearch_files/figure-html/unnamed-chunk-218-1.png" width="576" /></p>
<p>Create a subset called <code>summer</code> with just the summer days:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">summer &lt;-<span class="st"> </span>chic %&gt;%
<span class="st">  </span><span class="kw">filter</span>(month %in%<span class="st"> </span><span class="dv">6</span>:<span class="dv">8</span>)</code></pre></div>
<p>Use <code>glm()</code> to fit a Poisson model of respiratory deaths regressed on temperature. Since you want to fit a Poisson model, use the option <code>family = poisson(link = &quot;log&quot;)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod_3 &lt;-<span class="st"> </span><span class="kw">glm</span>(resp ~<span class="st"> </span>temp, <span class="dt">data =</span> summer,
             <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">&quot;log&quot;</span>))
<span class="kw">summary</span>(mod_3)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = resp ~ temp, family = poisson(link = &quot;log&quot;), data = summer)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.9755  -0.7162  -0.1807   0.6927   3.6555  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 1.910317   0.058373  32.726   &lt;2e-16 ***
## temp        0.006137   0.002581   2.378   0.0174 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 1499.4  on 1287  degrees of freedom
## Residual deviance: 1493.8  on 1286  degrees of freedom
## AIC: 6425.4
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Use the fitted model coefficient to determine the relative risk for a one degree Celcius increase in temperature. First, remember that you can use the <code>coef()</code> function to read out the model coefficients. The second of these is the value for the temperature coefficient. That means that you can use indexing (<code>[2]</code>) to get just that value. That’s the log relative risk; take the exponent to get the relative risk.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(mod_3)</code></pre></div>
<pre><code>## (Intercept)        temp 
## 1.910316958 0.006136743</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(mod_3)[<span class="dv">2</span>]</code></pre></div>
<pre><code>##        temp 
## 0.006136743</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(<span class="kw">coef</span>(mod_3)[<span class="dv">2</span>])</code></pre></div>
<pre><code>##     temp 
## 1.006156</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="entering-and-cleaning-data-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reporting-data-results-1.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/geanders/RProgrammingForResearch/edit/master/03-exploringdata1.Rmd",
"text": "Edit"
},
"download": ["RProgrammingForResearch.pdf", "RProgrammingForResearch.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
